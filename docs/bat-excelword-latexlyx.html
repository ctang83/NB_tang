<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 bat, Excel/Word, Latex/Lyx | A Notebook of Chengxiang Tang</title>
  <meta name="description" content="Recording my learning stuff." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 bat, Excel/Word, Latex/Lyx | A Notebook of Chengxiang Tang" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Recording my learning stuff." />
  <meta name="github-repo" content="ctang83/NB_tang" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 bat, Excel/Word, Latex/Lyx | A Notebook of Chengxiang Tang" />
  
  <meta name="twitter:description" content="Recording my learning stuff." />
  

<meta name="author" content="Chengxiang Tang" />


<meta name="date" content="2022-01-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="online-book-and-dashboard.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notebook Tang</a></li>  

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#learn"><i class="fa fa-check"></i><b>1.0.1</b> Learn</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="online-book-and-dashboard.html"><a href="online-book-and-dashboard.html"><i class="fa fa-check"></i><b>2</b> Online book and Dashboard</a>
<ul>
<li class="chapter" data-level="2.1" data-path="online-book-and-dashboard.html"><a href="online-book-and-dashboard.html#building-online-bookbookdown"><i class="fa fa-check"></i><b>2.1</b> Building online book(Bookdown)</a></li>
<li class="chapter" data-level="2.2" data-path="online-book-and-dashboard.html"><a href="online-book-and-dashboard.html#building-dashboardshinny"><i class="fa fa-check"></i><b>2.2</b> Building Dashboard(Shinny)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bat-excelword-latexlyx.html"><a href="bat-excelword-latexlyx.html"><i class="fa fa-check"></i><b>3</b> bat, Excel/Word, Latex/Lyx</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bat-excelword-latexlyx.html"><a href="bat-excelword-latexlyx.html#bat"><i class="fa fa-check"></i><b>3.1</b> bat</a></li>
<li class="chapter" data-level="3.2" data-path="bat-excelword-latexlyx.html"><a href="bat-excelword-latexlyx.html#excelword"><i class="fa fa-check"></i><b>3.2</b> Excel/Word</a></li>
<li class="chapter" data-level="3.3" data-path="bat-excelword-latexlyx.html"><a href="bat-excelword-latexlyx.html#latex-and-lyx"><i class="fa fa-check"></i><b>3.3</b> Latex and Lyx</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">With bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Notebook of Chengxiang Tang</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bat-excelword-latexlyx" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> bat, Excel/Word, Latex/Lyx</h1>
<div id="bat" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> bat</h2>
<p>A batch file(批处理文件) is a script file(.bat) in DOS, OS/2 and Microsoft Windows. It consists of a series of commands to be executed by the command-line interpreter, stored in a plain text file.</p>
<ul>
<li>build a new project</li>
</ul>
<ol style="list-style-type: decimal">
<li>先建立project文件夹</li>
<li>到D:_buildfolder.bat</li>
</ol>
<ul>
<li>模板</li>
</ul>
<pre><code>SET log=.\output\rundirectory.log

:: Clear output and externals 
DEL /F /Q .\output\     :: del命令只能删文件，rd命令删文件夹. 
rd Filemon              :: 删除文件夹。 /q参数表示，删除不需要确认。 /s参数表示删除该文件夹及其下面的子目录和文件
                        :: filemon文件夹和该bat文件在同一目录下，就省去具体路径
RMDIR .\external /S /Q
MKDIR .\external

:: Log start 
ECHO rundirectory.bat started &gt; %log%
ECHO %DATE% &gt;&gt; %log%
ECHO %TIME% &gt;&gt; %log%
DIR .\output\ &gt;&gt; %log%

:: Get externals
SET rev=4
SET svnpath=https://booth.svn.cloudforge.com/svndemo/trunk/
SVN export &quot;%svnpath%/analysis/output/regressions.tex@%rev%&quot; &quot;./external/regressions.tex&quot; --force -r%rev% &gt;&gt; %log%
SVN export &quot;%svnpath%/raw/data/potato.dta@%rev%&quot; &quot;../external/potato.dta&quot; --force -r%rev% &gt;&gt; %log%
SVN export &quot;%svnpath%/raw/data/tv.dta@%rev%&quot; &quot;../external/tv.dta&quot; --force -r%rev% &gt;&gt; %log%

:: Compile the paper
PDFLATEX .\source\tv_potato_submission.tex -output-directory=.\output\ &gt;&gt; %log%

:: Delete auxiliary files 
DEL .\output\tv_potato_submission.aux .\output\tv_potato_submission.log 

:: Merge files, clean resulting data set 
&quot;D:\stata13_SE_unsw\StataSE-64&quot; /e do mergefiles.do 
&quot;D:\stata13_SE_unsw\StataSE-64&quot; /e do cleandata.do

:: Run regressions 
&quot;D:\stata13_SE_unsw\StataSE-64&quot; /e do &quot;D:\svndemo\branches\analysis (alternative regressions)\code\regressions.do&quot;

:: Append log files 
COPY %LOG% + regressions.log %LOG%
DEL regressions.log

:: Log end 
ECHO rundirectory.bat completed &gt;&gt; %log%
ECHO %DATE% &gt;&gt; %log%
ECHO %TIME% &gt;&gt; %log%</code></pre>
<ul>
<li>bat重命名文件</li>
</ul>
<pre><code>ren aaa.txt bbb.doc   ::将 aaa.txt 命名为 bbb.doc
ren [Drive:][Path] filename1   filename2</code></pre>
<ul>
<li>复制cd.dll文件至windows</li>
</ul>
<p>copy cd.dll %windir%</p>
<ul>
<li>目录方式打开文件夹</li>
</ul>
<p>start explorer “D:and Inst”</p>
<ul>
<li>某个程序打开某个文件</li>
</ul>
<p>start D:_SE_unsw-64.exe “D:and Inst\0prog_IFRS.do”</p>
<ul>
<li>打开任何文件-如noteexpress</li>
</ul>
<p>start “” “D:.nel”</p>
<ul>
<li>添加注释–段首，段后</li>
</ul>
<p>start “” “D:\03090561111137697.pdf” ::打开pdf</p>
</div>
<div id="excelword" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Excel/Word</h2>
<ul>
<li><p>Excel以下内容可转至word, 再用通配符替换:</p></li>
<li><p>WORD中的通配符主要有：
*代表0至任意个字符；
^?代表任意字符；
^#代表任意数字；
^$代表任意字母；
^&amp;代表查找内容（在替换框使用，相当于原有内容基础上附加内容）。</p></li>
</ul>
<p>选择所有汉字， 在“查找内容”输入 [!<sup>1-</sup>127]</p>
<ul>
<li><p>产生随机数
=RANDBETWEEN(0,1) //随机产生0或者1，binary
=round(rand()，2） //随机产生0-1之间任意小数</p></li>
<li><p>excel中换行？？ alt+回车</p></li>
<li><p>excel快速下拉填充, 双击填充格右下角黑色十字标记</p></li>
<li><p>加总
=SUM(1/COUNTIF(D2:D477,D2:D477))
按 ctrl+shift+enter 结束输入</p></li>
<li><p>excel 批量插入空行 的方法：</p>
<ol style="list-style-type: decimal">
<li>用alt+F11进入VBE编程</li>
<li>双击左边你的工作表名称</li>
<li>复制以下代码：</li>
</ol>
<pre><code>Sub 添加4空行()
Do While ActiveCell &lt;&gt; &quot;&quot;
  ActiveCell.Offset(1, 0).Resize(4, 1).EntireRow.Insert shift:=xldowm
  ActiveCell.Offset(5, 0).Select
Loop
End Sub</code></pre>
<ol style="list-style-type: decimal">
<li>Alt+Q返回Excle</li>
<li>将光标停在需要插行的下一行按Alt+F8插入，遇到空单元格会停止插入。</li>
<li>注：这个操作无法撤消。</li>
<li>若想加更多行修改(4,1)和(5,0)数据</li>
</ol></li>
<li><p>只去除全部汉字：全部替换[!<sup>1-</sup>127]，且高级→通配符</p></li>
<li><p>在年月日中间插入空格如：20090805成为2009 08 05
方法：=REPLACE(REPLACE(A1,5,,” “),8,,” “)
=TEXT(A1,”0000 00 00”)</p></li>
<li><p>EXCEL去掉原来表格中的函数—-复制→右键，选择性粘贴，数字格式</p></li>
<li><p>格式选定的“自定义”中可以显示“年月yyyy-mm”</p></li>
<li><p>excel中即使没有19也会默认为19xx开头的年份，这点很好，省的加19</p></li>
<li><p>excel中批量去除空行：编辑→定位→空值→删除-整行</p></li>
<li><p>各种符号</p></li>
</ul>
<p>Excel中“&amp;”这个符号表示“与”</p>
<p>数据计算 ABS 求出参数的绝对值。</p>
<p>条件判断 AND “与”运算，返回逻辑值，仅当有参数的结果均为逻辑“真（TRUE）”时返回逻辑“真（TRUE）”，反之返回逻辑</p>
<p>条件判断 “假（FALSE）”。</p>
<p>数据计算 AVERAGE 求出所有参数的算术平均值。</p>
<p>显示位置 COLUMN 显示所引用单元格的列标号值。</p>
<p>字符合并 CONCATENATE 将多个字符文本或单元格中的数据连接在一起，显示在一个单元格中。</p>
<p>条件统计 COUNTIF 统计某个单元格区域中符合指定条件的单元格数目。</p>
<p>显示日期 DATE 给出指定数值的日期。</p>
<p>计算天数 DATEDIF 计算返回两个日期参数的差值。</p>
<p>计算天数 DAY 计算参数中指定日期或引用单元格中的日期天数。</p>
<p>DCOUNT 返回数据库或列表的列中满足指定条件并且包含数字的单元格数目。 条件统计</p>
<p>FREQUENCY 以一列垂直数组返回某个区域中数据的频率分布。 概率计算</p>
<p>IF 根据对指定条件的逻辑判断的真假结果，返回相对应条件触发的计算结果。 条件计算</p>
<p>INDEX 返回列表或数组中的元素值，此元素由行序号和列序号的索引值进行确定。 数据定位</p>
<p>INT 将数值向下取整为最接近的整数。 数据计算</p>
<p>ISERROR 用于测试函数式返回的数值是否有错。如果有错，该函数返回TRUE，反之返回FALSE。 逻辑判断</p>
<p>LEFT 从一个文本字符串的第一个字符开始，截取指定数目的字符。 截取数据 Left(A1, 2)</p>
<p>LEN 统计文本字符串中字符数目。 字符统计</p>
<p>MATCH 返回在指定方式下与指定数值匹配的数组中元素的相应位置。 匹配位置</p>
<p>MAX 求出一组数中的最大值。 数据计算</p>
<p>MID 从一个文本字符串的指定位置开始，截取指定数目的字符。 字符截取</p>
<p>MIN 求出一组数中的最小值。 数据计算</p>
<p>MOD 求出两数相除的余数。 数据计算</p>
<p>MONTH 求出指定日期或引用单元格中的日期的月份。 日期计算</p>
<p>NOW 给出当前系统日期和时间。 显示日期时间</p>
<p>OR 仅当所有参数值均为逻辑“假（FALSE）”时返回结果逻辑“假（FALSE）”，否则都返回逻辑“真（TRUE）”。 逻辑判断</p>
<p>RANK 返回某一数值在一列数值中的相对于其他数值的排位。 数据排序</p>
<p>RIGHT 从一个文本字符串的最后一个字符开始，截取指定数目的字符。 字符截取</p>
<p>SUBTOTAL 返回列表或数据库中的分类汇总。 分类汇总</p>
<p>SUM 求出一组数值的和。 数据计算</p>
<p>SUMIF 计算符合指定条件的单元格区域内的数值和。 条件数据计算</p>
<p>TEXT 根据指定的数值格式将相应的数字转换为文本形式 数值文本转换</p>
<p>TODAY 给出系统日期 显示日期</p>
<p>VALUE 将一个代表数值的文本型字符串转换为数值型。 文本数值转换</p>
<p>VLOOKUP 在数据表的首列查找指定的数值，并由此返回数据表当前行中指定列处的数值 条件定位</p>
<p>WEEKDAY 给出指定日期的对应的星期数。 星期计算</p>
</div>
<div id="latex-and-lyx" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Latex and Lyx</h2>
<ul>
<li>pdfpages宏包插入文件无页码的解决</li>
</ul>
<pre><code>在\includepdf命令之前加入\includepdfset{pagecommand={\thispagestyle{plain}}}，就可以对后面的所有include加页码。</code></pre>
<ul>
<li>文章中长横线 <span class="math inline">\(-\)</span> %即数学模式的减号</li>
</ul>
<pre><code>\item
\item[]  % 这样就没有前面一横</code></pre>
<ul>
<li>插入pdf图片代码：</li>
</ul>
<pre><code>  \begin{figure}[htbp!] 
    \centering    
    \includegraphics[width=12cm]{./output/Pat_see_Doc_on_expected_profit.pdf}\\
    \caption{Patients&#39; decision to see Doctor (get diagnosis) on expected profit}  \label{fig2}
    \end{figure}</code></pre>
<ul>
<li><p>多人合作修改latex文档：
一是导言区加 \usepackage[inline]{trackchanges} 和 \addeditor{Tang}
二是在latex文中加 \note[Marian]{。。。。。。。}</p></li>
<li><p>latex-caption-加上标，不用 ^, 而用
\textsuperscript{1}</p></li>
<li><p>主latex文件夹下output文件夹插入：
\input{./output/filename.tex}</p></li>
<li><p>正文中插入数学符号需要数学环境: <code>\(\theta\)</code> or <code>$\theta$</code></p></li>
<li><p>online latex: sharelatex .vs. writelatex
最后决定用writelatex， google account登录, 主要是其模板很好，可下载了自己单机用</p></li>
<li><p>Q: 在Beamer中如果直接用pdflatex编译，则eps格式的图形无法识别，这样，一种方法是将eps转换为pdf格式。对于少量需要转换的图形，这种方法无可厚非，但是若有大量的文件需要转换，则转换调整会花费大量精力。如何直接在beamer中应用eps格式的文档呢？
A: 若直接插入eps格式到beamer中，需要通过dvi-ps-pdf形式来生成幻灯片。具体做法：</p>
<ol style="list-style-type: decimal">
<li>与其他tex文件一样，首先使用Texify编译源文件,得到dvi文件。</li>
<li>使用dvi2ps，生成ps文件。</li>
<li>使用ps2pdf，生成pdf文件，这也是最终需要得到的文件。</li>
</ol></li>
<li><p>latex + dvipdfmx 编译的话，eps、pdf、png、jpg 都可以用</p></li>
<li><p>设置字体大小命令由小到大依次为：</p></li>
</ul>
<pre><code>\tiny
\scriptsize
\footnotesize
\small
\normalsize
\large
\Large
\LARGE
\huge
\Huge</code></pre>
<pre><code>横向距离  \hspace{1cm}
纵向距离  \vspace{1cm}

两个quad空格    a \qquad b      两个m的宽度
quad空格  a \quad b       一个m的宽度
大空格 a\ b        1/3m宽度
中等空格    a\;b        2/7m宽度
小空格 a\,b        1/6m宽度
没有空格    ab      
紧贴  a\!b        缩进1/6m宽度</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="online-book-and-dashboard.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ctang83/NB_tang/tree/master/02-write.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
