[["index.html", "My Notebook Chapter 1 Intro &amp; Records 1.1 2022年 1.2 2010-2012年", " My Notebook CTang 2022-04-19 Chapter 1 Intro &amp; Records This notebook covers my daily improvements in both knowledges and skills. 1.1 2022年 1.1.1 April 利用blogdown/netlify/hugo自建个人网页 选择Wowchemy的github包为基础 (Wowchemy多主题:course/网页slides/blog/ 选择wowchemy的Academic Resumé建个人网页 需要装(1)Go语言(网页下载自行安装),(2)Hugo(通过R安装) 主要修改 “config” and “content” 文件夹 个人网页上可以挂slides, project, notebooks, links, posts, PDF, 成为一个info hub了 开始全面转向VScode编辑器, 界面实在太酷了, 操作太爽了 VScode下面bar可以attach to R/Python/Shell/Stata (各种extensions支持) 一个Workspace可以管理多个项目, 对web development和markdown语法特别友好 和Github同步协作特别好 VScode命令Ctrl+Shift+P打开命令框 What is a value-based health care system? Value-based healthcare is a healthcare delivery framework that incentivizes healthcare providers to focus on the quality of services rendered, as opposed to the quantity. Under a value-based healthcare model, healthcare providers (including hospitals and physicians) are compensated based upon patient health outcomes. 1.1.2 March 要不要建一个图床? 给所有图片外链 - Image Hosting Website（或者其他英文名，反正不是什么Image Bed、Photo Bed 之类的） 1.1.3 Feb Debug: RStudio couldn’t work well if R libraries are synchronized, I’m considering transfer the platform to RStudio Cloud, like Deepnote-Python. 1.1.4 Jan 以下情况不需要伦理审查 Do I need to apply for ethics approval? In cases where data are collected for the purpose other than research, you might not need to submit an ethics application. This might be the case if your project falls into one of the following categories of data collection or use: Archival data, if it is from a public domain Please note, you will have to apply for ethics approval if the information you intend to use is identified personal information (states or implies identity), not in a public domain or if you will collect data in addition to the archival research. Administrative data collection Collection of data from staff or other stakeholders for the purposes of informing or improving a process within your organisation is not considered research. Still, if you later decide to use this data for research purposes, you will need to apply for ethics approval. In addition, the use of identified data always requires ethics approval. Teaching and learning If you collect human data solely for teaching or learning purposes and do not expect to publish or present any data, no ethics application is necessary. However, if you think the project may be published, it is recommended that you apply for ethics approval before running the project, as this is easier than getting approval subsequently. Quality assurance or clinical audit Usually data collected for quality assurance purposes or an audit, does not require ethical review, if it is for your organisation’s own information. However, if information is to be taken outside the organisation and used for a published paper, research project etc, this is considered research and requires ethical review. Negligible risk research involving collections of non-identifiable data Your research involves negligible risk if you use existing non-identifiable data or records or if it does not involve any foreseeable risk of harm or discomfort, which means there must not be the possibility of anything more than inconvenience. Although in this case you are not required to apply for ethics approval, you will probably need to complete a form to confirm that the project is of negligible risk, and provide a letter (or similar evidence of approval) from the person in charge of the data. 1.2 2010-2012年 1.2.1 8月25日 关于申请2012年“国家优秀自费留学生奖学金”的通知 2012-08-09 我可以申 Win episcope 等级评分也是定性资料！ 误差条图error bar chart 84-91-205 Approximately=a number of=some 各国都是以民营医疗为主体的现实…国进民退会不会体现在医改投入的效果中？私医院会不会退潮？降温？也就是政府医改投入对私部门的挤出？ me： 0404142385 bao： 0404151559 PassPort: G55112399 1/28 FORSYTH STREET, Kingsford, NSW, 2032 2816 chengxiang Essays on Physicians’ Choice Changes in drug utilization following the outpatient prescription drug cost-sharing program–evidence from China’s Win episcope 等级评分也是定性资料！ 误差条图error bar chart 84-91-205 Approximately=a number of=some bao： 0404151559 PassPort: G55112399 各国都是以民营医疗为主体的现实…国进民退会不会体现在医改投入的效果中？私医院会不会退潮？降温？也就是政府医改投入对私部门的挤出？ 1/28 FORSYTH STREET, Kingsford, NSW, 2032 13540617813 LCA有两个models：choice model, class membership model R 有个BayesLCA包，刚出，非常适合latent class model White, A. and T. B. Murphy, et al. (2014). “BayesLCA: An R Package for Bayesian Latent Class Analysis.” Journal of Statistical Software 61 (13). air quality improvement, latent class, preference heterogeneity: prefer status quo, prefer change?? One observable determinant of this preference heterogeneity is the exposure of individuals to health risks relating to air quality 利他 对 气候变化、器官移植影响？？？925452379636 how to divide classes in public and private hospital study: public-oriented, non-public-oriented patients DCE topics: organ transplant, blood transfusion, drunk driving, weather and agriculture outcome health &amp; policy focus on “health shock + regression discontinuity” labor focus on “tournament theory” 3 the health and health expenditure impacts of prostitution regulation in aus http://en.wikipedia.org/wiki/Prostitution_in_Australia http://en.wikipedia.org/wiki/Prostitution_and_the_law#Victimhood_issues 拟凹函数是定义在凸集上的满足以下性质的函数：任意两点的凸组合的函数值不小于这两个点的函数值中较小的一个；等价定义是这个函数的任一优集是凸集；如果二阶可微，则加边海赛矩阵的是半负定的 凹是基数性质，拟凹是序数性质，序数性质指在正单调变化下保持不变的性质 单调函数一定是拟凹的 拟凹性对最大化最小化问题是否有全局解，是否有唯一解的判断有用 假设一个消费者的 Bernoulli 效用函数是 u(x)=X^1/2他面对彩票 g=(1/2。16, 1/2。4)计算消费者的确定性等价 … Certainty Equivalent: c(1/2)=1/216^(1/2)+1/24(1/2)得到c=9; Probablility Premium:(1/2+x)(10+6)(1/2)+(1/2-x)(10-6)(1/2)=(10)^(1/2)得到x=[10^(1/2)-3]/2,这个就是probability premium,这里消费者的初始财富是10. 闭合形式解：一个能直接计算级数和或递归结果的等式。 通常来说: CLOSED FORM SOLUTION 是解析解, (相对于数值解而言) 见到很多文献中的牛人 G Bloom, T Evens, W Hsiao, 牛美女梁. 认识了不少研究者,美国的,国内的. 国际学术会议是需要做很多准备:一参与者的背景调查,因为他们会找你谈话,要认识牛人,如福籍美国的洪燕教授,还有哈佛的研究员.二是提高自己的英语听力和口语,两者缺一不可,这决定你能与他们交流的基本前提.三是学术水平,当然这还好,毕竟自己兴趣最重要,不指望结识所有研究者,而重在认识自己兴趣领域的. 学术会议是自由平等的场所,要勇于展示自己,这次自信心不够,不敢一开始站在自己海报前向有兴趣的研究者介绍自己和研究,错过认识更多人的机会.第一天上午本就有很多人看我海报,可惜我没信心上去介绍和攀谈,而学术会议最重要在于认识和展现自己,直到下午一小时必须站那,可惜没认识几个时间就过拉.另一个就是找自己感兴趣的研究,并主动攀谈研究者聆听其研究和看法最后要名片建立联系.这次回去可主动找西北大学那个表示兴趣和未见到他的遗憾. 另海报比口头展示更提高自己和人沟通的机会和技巧,我第二天发现不少口头展示听者聊聊了,所以学术会议每一分钟都价值千斤,要前期认真准备,中间认真听演讲努力展示自己研究课题和兴趣,多主动找兴趣类似研究者聆听他们的研究再建立联系,会后主动帮助她们沟通和联系她们. (自己名片必须的) 文献综述一篇，关于影响药师工作绩效的多因素。 http://www.sciencedirect.com/science/article/pii/S016885101100114X Human Capital的定义和表现形式值得借鉴： http://www.nber.org/papers/w17474.pdf 如何组建包含地理信息和distance的数据库，并计算对健康补助和健康产出的影响 http://www.nber.org/papers/w17471.pdf we own more knowledge, but use less 可惜共產革命在１９８９年就已經證明失敗了，不然全民公務員化還真是個救經濟、救失業的好點子 菲尔德斯坦说：医院的政治行为简直是描述经济学上自利人模型的完美例子。 Defenders of the new law invariably ignore the supply side of the market. They assume that if you insure the uninsured or give people more generous coverage that they will all get more health care without ever asking: who is going to provide that extra care? Purports to control total spending on physician services, but it controls only prices, even though spending is the product of the price and the number and intensity of services. We’ve seen that diagnostic imaging costs more in the U.S than elsewhere, but what about physician fees? This is arguably the most subjective part of the health care system. For example, do some countries value their physicians more than others? What about the emphasis on primary care versus the various specialties? 关键词： health care price physician specialization price regulation medical profession specialization regulation primary care physician specialization health economics labor division topics in medical economics specialization division of labor physician division of labor physician specialization physician fees医生费 Physicians can sell prescriptions directly to patients. Unsurprisingly, Japan has the highest consumption rate of pharmaceuticals per capita in the world. 背后的信念是因为确认医生在诊断和处方上有专业的技能,但非配药.相反,药师则在配药上有专业的训练。 所以，配药包括：“病人并可以选择在任何药房配药,而所配之份量亦可以依据病人的需要或经济上之不同而有所改变.同时处方上的不清,或病人不明百之处,药师可以直接与医生联络,立即改正处方或因应医生指示建议病人再访医生.再者药师亦能于释出药物时提供病人直接的服药指导.病人可在任何时候再访药房询问有关药物问题,而不需任何费用。配药学不只是数药丸,其实,药物的管理,病人的辅导更为重要”–即监督医生、校正处方、调整药品、指导病患。 咨询药物是否有FDA审核，副作用，还有什么别的现存药物治疗我的疾病，新药的最新资讯，有替代的非专利药物吗(Generic Drugs)，非专利药物是否和我的有商标名称的药物(brand-name drugs)本质类似，其效果又如何，有非处方药(OTC)吗，其与处方药有差异吗，有没有饮食补充方法，我从哪里找这些饮食信息？ Approved Drugs * How is medicine approved by FDA? * How can I find out if my medicine is approved by FDA? Side Effects * How can I find out about side effects or safety concerns for my drug? * Do drugs have risks? * How do I report a suspected drug side effect Treatments for Medical Problems * What approved drugs are available to treat my disease? * Since FDA cannot provide information about drugs in development, where can I go to learn more about them? Generic Drugs * What are generic drugs? * Is there a generic equivalent for my brand-name drug? * Are generic drugs as effective as brand-name drugs? Prescription Drugs and Over-the-Counter (OTC) Drugs * What is the difference between prescription drugs and OTC drugs? Dietary Supplements * What is a dietary supplement? * Where can I find information about dietary supplements? 第一步亦是最易接受的就是争取病人的”取方权”–这是属于四种策略哪种？ –重要的不是在哪买药，而是经济环境条件是否更适合医生和药师选择自己怎样专业化，也就是医生和药师的选择，只要他们选择好了，其他都不是问题！ 医生可以直接卖药给患者，而不是医生只提供诊断服务和治疗建议，由药师配药。这就是SPD问题，本质上是分工问题，药师没有参与到患者的治疗过程中来。常常导致的问题就是人均药品消费超高，即使发达如日本也不能例外。 Modern prescriptions evolved with the separation of the role of the pharmacists from that of the physician。 我的兴趣： 一个是分工理论在GP-physician和doctor-pharmacist的演化中的作用 二是中国卫生系统–这个无论是价格机制还是分工机制都messy的东西 从历史来看，药剂制作和（类）药剂师的出现，无论中国和西方都有几百上千年的历史，见Du liping的”Professional Code or Legal Sanctions: Pharmacy in China”和”Kremers and Urdang’s History of pharmacy” By Edward Kremers, Glenn Sonnedecker这两本书。 中国会不会存在这样一个问题： 因为价格机制管制→导致GP-physician和doctor-pharmacist的分工无法演进？ 也就是说fixed price system→分工停止（虽然也有人为的复制西方分工体系，但多失败）→效率无法提高？ 换句话说，价值制度决定分工水平和演进 Folland的卫生经济学书version6的第338页有讲physician的专业化一小节，注意是physician，不是全部medical professions。 差异化和专业化有什么区别？有什么关联？ 亚当·斯密为代表的古典经济学关于劳动分工是经济发展和增长的原动力这一伟大洞见，提供了微观机制和数学框架 劳动分工理论对于管理理论的发展起到了十分重要的作用，后来的专业分工、管理职能分工、社会分工等理论，都与斯密的这一学说有着“血缘关系”。 阿罗称赞杨的研究使亚当。斯密的劳动分工论与科斯的交易费用理论浑为一体 全民健保名字里虽然有保险，其实不是保险，而且比保险更糟。 可以精算交通事故的机率，可以精算汽车险保费，但是病有万万种，台湾的健保早就没有精算疾病机率的这个程序了，因为根本做不到。没办法精算大小疾病的机率，健保管理就不是保险管理，而是预算管理。 健保比保险更糟，是因为保险里「第三方付费」的机制，在精算机率和政府监管的前提下，原本问题不明显。但是一旦健保变成预算管理，那使用者不管帐的第三方付费机制，就成了非常严重的「代理人问题」。 民众缴了保费，就不用管健保局怎么和医院打交道，也没有任何节省医疗支出的诱因，所以不看白不看。而且恶性循环，医疗费用因为民众不看白不看而愈来愈高，健保局只好调保费，而保费调愈高，民众愈觉得不看白不看。不管是一代健保的个人所得，或是二代健保的以家户所得计算基础，原理都是在调保费，没有任何解决「代理人问题」的机制。 芝加哥大学教授、曾获诺贝尔经济学奖的贝克（Gary S. Becker），评论欧巴马的健保改革时说，问题就是出在保险，健保改革还扩大保险的范围？很不幸，我们的健保已经是全民强制纳保，也就是说，我们早就走上医疗支出无法控制的不归路了。一项鲜为人知的数据是，台湾人缴的健保保费已经比综合所得税还多了，而且以后只会更多，不会更少。 英國公醫制度在不少人眼裡也許沒什麼不好，但是英國的醫療品質在歐盟裡最差，醫生收入、地位最低，醫療支出還名列前茅也是不爭的事實。 There are 6 features which contribute to the benefits on a popoulation’s health, associated with primary care. (Starfield et al., 2005) These benefits are improved access to services, improved quality of care, more emphasis on prevention, early management of health problems, combined effect of primary care delivery characteristics and the role of primary care in reducing unnecessary and potentially harmful specialist care. (Starfield et al., 2005) General practice was first introduced into parts of urban China in 1999. (Liu, 2005) CHC was introduced in 1998. (Pan et al., 2006) a major determinant of a patient’s satisfaction with care provided is their initial expectations, which can be shaped by a number of variables, including “socio-demographic and socioeconomic factors, past experience, needs, and word-of-mouth influence.” (Tam, 2007)Recently research seeking to understand patient’s perspectives has moved from asking about patient satisfaction, which can be difficult to interpret to enquiring about patient experiences with healthcare. (Davies and Cleary, 2005) The John Hopkins PCAT’s four main domains assess the structure and process of primary care service provision The John Hopkins Primary Care Assessment Tool was selected for use to assess patients’ experience of quality. Measuring patient experience of quality rather than patient satisfaction was a key feature when choosing the research instrument, given increasing dissatisfaction with measuring patient satisfaction, due to difficulty in interpreting patient satisfaction results. (Berendsen et al., 2009; Davies and Cleary, 2005) As part of the calculation of sub domain scores a score of 9 - not sure, was converted to a score of 2.5 for all sub-domains, except comprehensiveness, where a score of 9-not sure was converted to 0. Instead, during the interviews the research assistant conducted the interview and the translator translated the main points of the interview as the interview was ongoing. This allowed the opportunity to ask some questions as the interview progressed. Rozi，你要注意：extent of affiliation和 ongoing care是同属于一个主构面下面的分构面。 在6个缺失变量里，即无法确认PCP的的患者里，z贡献了5个，而我只造成一个 讲一下本科生的gp实习问题， 安泰中心实习两周变为一周 而r在英国两年时间里每周要去gp诊所实习一个下午，在第四五年级每年都要去实习4周，如果把实习作为一种暴露的话，那么是否更长的实习时间能够影响医学生下基层工作的意愿呢？以前看过一篇类似的JAMA的文章，就讲美国的医学生受哪些影响更愿意从事内科和家庭医生 以下记录几个我和rozi发现的，还可以继续研究的课题： 1、看病时的隐私，针对大医院诊室里病人的拥挤和不排队现象。提问：是否我们的病人就真的不在乎隐私呢？ 2、为什么医学院校把两周的社区卫生服务实习时间改为一周，因为对比UK的培养体制，他们的医学生大量时间在GP实习 3、CHC的病人上午下午极不相同，上午挤了很多人，下午有3-4个医生却没有病人。虽然他们说下午医生都去家庭访视了，但是R和我奇怪，他们在做完health records以后，还用每天下午都去居民家中，如果去的话都是提供什么服务呢？ –120元的限价 FDA–which determines effectiveness of a drug regardless of cost NICE–which determines not only whether a drug is effective, but whether these health improvements are worthwhile considering the drug’s cost. “当医生不知道一个检查、一片药丸要多少钱的时候，医改就成功了。至于民众是否看得起病，那就是保障体系建设的问题了。”廖新波说。——–这个命题假设是否合理？？待检验 社会医学课程—预防、临床（其实质是治疗医学）、康复及临终关怀，三块分了病人 不是所有人都相信中国宏伟的医改方案会取得成功。上海一家大医院的资深外科医生宋科瑛认为医改在短期内不会有什么效果。宋医生持有中国和美国的两个医学博士后学位。他指出医改方案缺少面向医生的激励政策，因为国内医生的待遇比西方同行要低很多。因此，他认为要减少医院的药品销售提成很可能不会奏效。至于总值8500亿元的投资，宋医生认为中国市场太庞大、医院数量太多，单个社区卫生服务中心收到的投资将非常有限。他认为医改应当解决医生的低待遇处境，而医改方案中并未提到这个问题。 医改还在细节处，公共政策还在细节处。医疗成本与财务权多大程度控制在个人手上有正相关，当然它还受其他如支付方式、保险影响。 想法：经济水平和卫生服务人员的配置模型，本来卫生人资配置主要考虑疾病需求和收入，这里从经济水平寻找一个平均标准，并测算福建地域内的配置是否合理。 全文—–专门的数据库生产商—EBSCO、OVID、ProQuest 全文——出版社或专业学会——ElsevierScience、Springer、John Wiley 全文和文摘—-联机检索系统—-Dialog 文摘为主——OCLC FirstSearch、Scopus（包括社会科学方面的信息资源） EBSCO全文数据库（含文摘或全文） paper多数是指高校的学术论文与研究 这个词多用于美国英语 essay的意义跟paper差不多，不过一般是更短更简单、有特定主题的那种，它的学术层次比paper要低一些，许多时候是指就一个具有争议性论题所进行的讨论。 1.2.2 2011年5月24日 – Visa/Passport information ★ –whenever扫描发过去都行 – Proof of English Ability – Notarised/Certified Transcript – Details of previous research – Sponsorship Letter –（You must download the Sponsor Contract Form, which must be completed and submitted to the relevant Admissions Office.） ★ –没影响 – Research Plan – Proof of contact with supvsr ★ – Curriculum Vitae 1.没有办护照，没有visa信息，能不能推迟给而不影响奖学金申请~ 推迟的话，最后的日期是多少，可以说明你现在不在户口所在地，护照办理不方便 2. 之前邮件中提到的 Sponsorship Letter 问题，是你犯的一个错误，在提交申请资料的时候，遇到Will you be sponsored by an Official UNSW Sponsor ?时，你应该选择NO，但是你选了yes，事实上商学院并没有和你谈及至奖学金，只是小蜜提醒你可以申请这个奖学金。 昨天决定，接受ucf offer（中佛）。我有以下缺点： 1） 我的本科学校及美国的学校都一般。 2） 没有金融的推荐信，虽然我的推荐人肯定会强力推荐，但作用应该不大。 3） 没有金融方面的论文。 4） 年龄已经大到影响申请。 5） 背景太复杂，多半人并不喜欢。 所以我申请的定位并不高，除了Rice 算好一点（但第一批得到拒信， 其他的都一般。offer得到的很早，funding 很好，20000GTA+5000summer fellowship, 如果 暑期教课，每门3000， 不过也就教一门课吧，因为他们学校要求前两个暑期各完成一篇论文。 钱对我很重要，关系到全家人的生活，所以接到这个offer后，基本上就不再考虑offer低于20000的学校了。 2.对于研究方向，如果不是特别清楚（其实我觉得在入学前，根本不必要把自己的定位搞得太死板），不必太执著于某一方向，选校时要综合考虑，但是在自我陈述中一定要指出来，根据不同的学校，应有不同的研究方向。 3：选校时可以把简历发给PHD coordinator, 让他们看一下，顺便问一下学校招生情况，多半时候会有答复，从回信中可以看出他是否对你感兴趣。positive的回复不代表offer, 但恢复若是negtive， 就一定不要申请， 无论你多想。 4：尽早完成申请，越早越好，并不是所有学校只有到截止日期后才审材料。 5：陶瓷可以，但最好在审材料以前。 6：申请的时候越仔细越好。 7：没有哪个学校可以保底，你申请的最差的学校只不过是你的底线而已。 letters of recommendation should address your potential as a scholar based on their experience with you as a student, research assistant, or teaching assistant. 美国大学的研究生奖学金，对于国际学生而言，主要分为两类：非服务性奖学金（Non-Service Scholarship）、服务性奖学金（Service Assistantship）。非服务性奖学金包括Fellowship（学院助学金）、Scholarship（奖学金）、Tuition &amp; Fee Waiver（全免学杂费）以及Awards（奖励）。 1．Fellowship是金额最高、但竞争最激烈的非服务性奖学金。一般情况下，获得Fellowship，便是获得了全奖，即除了免学费杂费、住宿费、保险费、书本费以外，还给获奖学生一定金额作为其个人消费费用。 2．Scholarship形式多样，可以是作为某种奖学金形式颁发给成绩优异的学生，也可以是免除学费或杂费。Scholarship的具体金额，也会随着学院规定的学杂费金额高低而不同。Scholarship不像Fellowship那样只有一种形式，在同一所大学可能设置几种甚至十几种不同形式的Scholarship，一个学生也可以有资格同时申请两种以上的Scholarship。 3．Tuition &amp; Fee Waiver：在一些美国学院中，设有全免学费的奖学金，有的学院把它作为Scholarships的一种，有的学院把它单独列出。全免学费是在非服务性奖学金中最易申请的一种，然而虽然免去了学费,但由于学费只是总花费的一部分，所以如果要获得足够的资金，还需同时申请其他形式的奖学金。 服务性奖学金包含Teaching Assistantship（简称TA，助教），Research Assistantship（简称RA，助研）和On-Campus Job三种。获得TA/RA的资助者，每周需担任12-20小时的辅助教学或研究工作。这种经济资助只提供给硕士或者博士申请者。对于申请美国研究生以上级别的中国学生来说，获得奖学金的机率会比本科生或本科转学生大得多，多数都是以拿到这两种服务性薪金的一种来获得全奖的。绝大多数的美国高校研究生院，都设置这两种资助，然而并非所有学院的此类资助都能覆盖一年中的全部费用，但多数都在全部金额的2／3以上。不过很多学校提供这种奖学金的同时，还会给学生免学杂费，也就相当于申请到“全奖”。不过，TA/RA所得是要纳税的。校内工作 (On-Campus Job)也是服务性薪金的一种，学生通过学校提供的校内工作来获得一定收入。美国移民局规定，国际学生可以在校内合法工作，每小时最低为5.15美金，每周最多可以工作20小时，假期可以工作40小时。校园工作包括在大学食堂、书店、图书馆或健康俱乐部等地方打工，或者在大学的行政办公室帮忙。 1.2.3 2010年10月 十所学校选定，UGA看情况说。 我们强烈推荐所有申请者查看HPM课程在申请前。 PhD申请 面試這種事情 做久了會彈性疲乏 所以大家要找工作 最好在工作一開放就趕快去丟 你越晚丟 你就處於越不利的狀態 這是基本初步的建議 1強大的邏輯能力 2精確的知識引用能力 3並清楚自己的賣點 50之前的都要牛推！我恐怕很难啊 你直接跟张老师联系下 问问清楚 或者直接打办公室电话 问问管学生教学的 这个事情建议你回来直接找哈王亨洪或李洪军 你要是去教务处, 他们是可以给你开证明， Philosophy of economics, economic methodology, history of economics, relation of economics to social values, social economics, ethics and economics, health economics, international economics. Philosophy and Methodology of Economics, History of Economics, International Economics, Ethics and Economics, Health Economics. 邮寄材料到北美-EMS-15天，国际快递5天内, 可寄龙翕，他转寄，省钱，他一封6刀 DHL：中外运-敦豪福建分公司 中国福建省 福州市仓山区盖山投资区高旺路9号5号楼1-2层 + 86 (591) 87321111 350007 否 请您拨打800-810-8000预约取件 GRE 建议NO.的填空做2遍, 因为填空句子比国内题句子稍难,但逻辑很清晰,对做题思路的训练很有帮助 -ive结尾，表示人喜欢做这件事 GRE考得多的单词可以看出美国人对其的偏爱，哈哈 类比关系要有必然性在里面：比如“灵巧的人”是“灵巧的” 福州仓山区中医院数据输入了两遍 保护坏参与者会伤害所有参与者，而且帮不到任何人 Win episcope 重要的經濟觀點，通常是正確但不明顯(universally true, but not obvious) 等级评分也是定性资料！！切记 10.100.246.38 / 254 10.46.2.16 2号线6站到中山公园转3号线 My confirmation number is 8850000000499691. REGISTRATION NUMBER: 6610367 登陆时用confirmation那个 连日期都不用输 顶边1.85+1.45 读-听-说-写 1、为什么我们要相信你有在这个领域做研究的潜力？ 2、你觉得你正在做什么？为什么？ 3、好的PS包括你做过的项目和这个领域相关研究的引用！ the most important character trait in research is not intelligence, but self-disciplin. So, if you want prove that you have potential, prove that you have the fortitude to take on the system 217-4184643 谢亮手机 Food Science and Engineering Food Sci &amp; Engineering Business Administration Social Medicine &amp; Health Administration 09/01/2002 09/01/2004 06/30/2006 baccalaureate degree Fujian Medical University 09/01/2008 06/30/2011 Lieping Chen clpqsc@126.com Fujian Medical University 0086-13763834045 Weiguang Zhang zwguang@swu.edu.cn Southwest University College of Food Science 13983485159 Rosalind McCollum Concern Worldwide rosalind.mccollum@concern.net Ireland Chongqing Southwest University Attended From 09/01/2002 To 06/30/2006 Degree Bachelor of Engineering Received 06/30/2006 Southwest University Attended From 09/01/2004 To 06/30/2006 Degree Bachelor of Business Administration Received 06/30/2006 统计、数学、经济课程： Advanced Mathematics-2002, Probability Theory-2003, Linear Algebra-2003, Microeconomics-2004, Macroeconomics-2004, Medical Statistics-2008, Health Economic-2009 电脑编程、数据库课程：VB Programming(2004) 5187 0000 EMORY U GRAD SCH 2074 1903 CARNEGIE MELLON UNIVERSITY PUBLIC POLICY STUDIES 1565 0000 NORTHWESTERN UNIVERSITY 5816 0616 U NORTH CAROLINA CHAPEL HILL PUBLIC HEALTH 去北美第一要点是：选项目，既不是选博导，也不是选学校！！切记 Chengxiang Tang MHA. Candidate School of Public Health, Fujian Medical University 88 Jiaotong Road, Fuzhou, Fujian, 350004, PRC Cell: 860591-13705914418 Email: tang.chengxiang@gmail.com 方向：primary care, provider, rual area, Health Manpower Management（Merged with Journal of Management in Medicine in 1999） key words： human resources for health 最常使用 heath human resources 这个词加拿大使用非常频繁 health workforce health staff health manpower 原来这是90年代前用的词 Health Personnel Personnel &amp; human resources management Personnel management "],["bat-excelword-lyxlatex.html", "Chapter 2 bat, Excel/Word, Lyx/Latex 2.1 bat 2.2 Excel/Word 2.3 Lyx/Latex", " Chapter 2 bat, Excel/Word, Lyx/Latex 2.1 bat A batch file(.bat 批处理文件) is a script file in DOS, OS/2 and Microsoft Windows. It consists of a series of commands to be executed by the command-line interpreter, stored in a plain text file. build a new project 先建立project文件夹 到D:_buildfolder.bat 模板 SET log=.\\output\\rundirectory.log :: Clear output and externals DEL /F /Q .\\output\\ :: del命令只能删文件，rd命令删文件夹. rd Filemon :: 删除文件夹。 /q参数表示，删除不需要确认。 /s参数表示删除该文件夹及其下面的子目录和文件 :: filemon文件夹和该bat文件在同一目录下，就省去具体路径 RMDIR .\\external /S /Q MKDIR .\\external :: Log start ECHO rundirectory.bat started &gt; %log% ECHO %DATE% &gt;&gt; %log% ECHO %TIME% &gt;&gt; %log% DIR .\\output\\ &gt;&gt; %log% :: Get externals SET rev=4 SET svnpath=https://booth.svn.cloudforge.com/svndemo/trunk/ SVN export &quot;%svnpath%/analysis/output/regressions.tex@%rev%&quot; &quot;./external/regressions.tex&quot; --force -r%rev% &gt;&gt; %log% SVN export &quot;%svnpath%/raw/data/potato.dta@%rev%&quot; &quot;../external/potato.dta&quot; --force -r%rev% &gt;&gt; %log% SVN export &quot;%svnpath%/raw/data/tv.dta@%rev%&quot; &quot;../external/tv.dta&quot; --force -r%rev% &gt;&gt; %log% :: Compile the paper PDFLATEX .\\source\\tv_potato_submission.tex -output-directory=.\\output\\ &gt;&gt; %log% :: Delete auxiliary files DEL .\\output\\tv_potato_submission.aux .\\output\\tv_potato_submission.log :: Merge files, clean resulting data set &quot;D:\\stata13_SE_unsw\\StataSE-64&quot; /e do mergefiles.do &quot;D:\\stata13_SE_unsw\\StataSE-64&quot; /e do cleandata.do :: Run regressions &quot;D:\\stata13_SE_unsw\\StataSE-64&quot; /e do &quot;D:\\svndemo\\branches\\analysis (alternative regressions)\\code\\regressions.do&quot; :: Append log files COPY %LOG% + regressions.log %LOG% DEL regressions.log :: Log end ECHO rundirectory.bat completed &gt;&gt; %log% ECHO %DATE% &gt;&gt; %log% ECHO %TIME% &gt;&gt; %log% bat重命名文件 ren aaa.txt bbb.doc ::将 aaa.txt 命名为 bbb.doc ren [Drive:][Path] filename1 filename2 复制cd.dll文件至windows copy cd.dll %windir% 目录方式打开文件夹 start explorer “D:and Inst” 某个程序打开某个文件 start D:_SE_unsw-64.exe “D:and Inst\\0prog_IFRS.do” 打开任何文件-如noteexpress start “” “D:.nel” 添加注释–段首，段后 start “” “D:\\03090561111137697.pdf” ::打开pdf 2.2 Excel/Word 取消Word文档中所有超链接: 先Ctrl+A(全选)；然后，Ctrl+Shift+F9(取消超级链接)。 Excel以下内容可转至word, 再用通配符替换: WORD中的通配符主要有： *代表0至任意个字符； ^?代表任意字符； ^#代表任意数字； ^$代表任意字母； ^&amp;代表查找内容（在替换框使用，相当于原有内容基础上附加内容）。 选择所有汉字， 在“查找内容”输入 [!1-127] 产生随机数 =RANDBETWEEN(0,1) //随机产生0或者1，binary =round(rand()，2） //随机产生0-1之间任意小数 excel中换行？？ alt+回车 excel快速下拉填充, 双击填充格右下角黑色十字标记 加总 =SUM(1/COUNTIF(D2:D477,D2:D477)) 按 ctrl+shift+enter 结束输入 excel 批量插入空行 的方法： 用alt+F11进入VBE编程，双击左边你的工作表名称，复制以下代码： Sub 添加4空行() Do While ActiveCell &lt;&gt; &quot;&quot; ActiveCell.Offset(1, 0).Resize(4, 1).EntireRow.Insert shift:=xldowm ActiveCell.Offset(5, 0).Select Loop End Sub Alt+Q返回Excel, 将光标停在需要插行的下一行按Alt+F8插入，遇到空单元格会停止插入。 注：这个操作无法撤消; 若想加更多行修改(4,1)和(5,0)数据 只去除全部汉字：全部替换[!1-127]，且高级→通配符 在年月日中间插入空格如：20090805成为2009 08 05 方法：=REPLACE(REPLACE(A1,5,,” “),8,,” “) =TEXT(A1,”0000 00 00”) EXCEL去掉原来表格中的函数—-复制→右键，选择性粘贴，数字格式 格式选定的“自定义”中可以显示“年月yyyy-mm” excel中即使没有19也会默认为19xx开头的年份，这点很好，省的加19 excel中批量去除空行：编辑→定位→空值→删除-整行 各种符号 Excel中“&amp;”这个符号表示“与” 数据计算 ABS 求出参数的绝对值。 条件判断 AND “与”运算，返回逻辑值，仅当有参数的结果均为逻辑“真（TRUE）”时返回逻辑“真（TRUE）”，反之返回逻辑 条件判断 “假（FALSE）”。 数据计算 AVERAGE 求出所有参数的算术平均值。 显示位置 COLUMN 显示所引用单元格的列标号值。 字符合并 CONCATENATE 将多个字符文本或单元格中的数据连接在一起，显示在一个单元格中。 条件统计 COUNTIF 统计某个单元格区域中符合指定条件的单元格数目。 显示日期 DATE 给出指定数值的日期。 计算天数 DATEDIF 计算返回两个日期参数的差值。 计算天数 DAY 计算参数中指定日期或引用单元格中的日期天数。 DCOUNT 返回数据库或列表的列中满足指定条件并且包含数字的单元格数目。 条件统计 FREQUENCY 以一列垂直数组返回某个区域中数据的频率分布。 概率计算 IF 根据对指定条件的逻辑判断的真假结果，返回相对应条件触发的计算结果。 条件计算 INDEX 返回列表或数组中的元素值，此元素由行序号和列序号的索引值进行确定。 数据定位 INT 将数值向下取整为最接近的整数。 数据计算 ISERROR 用于测试函数式返回的数值是否有错。如果有错，该函数返回TRUE，反之返回FALSE。 逻辑判断 LEFT 从一个文本字符串的第一个字符开始，截取指定数目的字符。 截取数据 Left(A1, 2) LEN 统计文本字符串中字符数目。 字符统计 MATCH 返回在指定方式下与指定数值匹配的数组中元素的相应位置。 匹配位置 MAX 求出一组数中的最大值。 数据计算 MID 从一个文本字符串的指定位置开始，截取指定数目的字符。 字符截取 MIN 求出一组数中的最小值。 数据计算 MOD 求出两数相除的余数。 数据计算 MONTH 求出指定日期或引用单元格中的日期的月份。 日期计算 NOW 给出当前系统日期和时间。 显示日期时间 OR 仅当所有参数值均为逻辑“假（FALSE）”时返回结果逻辑“假（FALSE）”，否则都返回逻辑“真（TRUE）”。 逻辑判断 RANK 返回某一数值在一列数值中的相对于其他数值的排位。 数据排序 RIGHT 从一个文本字符串的最后一个字符开始，截取指定数目的字符。 字符截取 SUBTOTAL 返回列表或数据库中的分类汇总。 分类汇总 SUM 求出一组数值的和。 数据计算 SUMIF 计算符合指定条件的单元格区域内的数值和。 条件数据计算 TEXT 根据指定的数值格式将相应的数字转换为文本形式 数值文本转换 TODAY 给出系统日期 显示日期 VALUE 将一个代表数值的文本型字符串转换为数值型。 文本数值转换 VLOOKUP 在数据表的首列查找指定的数值，并由此返回数据表当前行中指定列处的数值 条件定位 WEEKDAY 给出指定日期的对应的星期数。 星期计算 2.3 Lyx/Latex 2.3.1 Lyx 多行注释 iffalse … fi iffalse 多 行 fi Lyx在article（即英文模板）使用中文方法： 在setting→Document Class→Class Options中的Custom一栏填入UTF8（这个选项将传送给ctex宏包）, 还要把语言的encoding设置为Unicode(XeTeX) (utf8) Lyx编译： ctrl+D or ctrl+R 在LaTeX Preamble中输入如下LaTeX 代码 \\usepackage{xeCJK} \\setCJKmainfont{SimSun} 只需点击View&gt;View[pdf(XeTeX)]即ctrl+R可完成编译 每一次新建文档，首先要选择文档的类型，这里以article的类型举例: 点击 File &gt; New ，新建一个空白文档， 点击 Document&gt; Settings 分别点击左侧的导航栏，在Document class中选择 CTeX，这是由于我们的文档中包含中文，参考文献， 目录的格式，CTeX类型的文档能给予很好的支持。 Language中选 Chinese (simplefied)，Encoding 选 Unicode (XeTeX) (utf8) 这是由于我们在后续编译LyX文档的时候， 要用到XeTeX程序，而要在正文中使用中文，xeCJK宏包的效果很好。 在output设置Default output format 为 PDF (XeTeX)，我们用XeTeX编译LyX文档， 生成PDF文档。 2.3.2 Latex pdfpages宏包插入文件无页码的解决 在\\includepdf命令之前加入\\includepdfset{pagecommand={}}，就可以对后面的所有include加页码。 文章中长横线 \\(-\\) %即数学模式的减号 \\item \\item[] % 这样就没有前面一横 插入pdf图片代码： \\begin{figure}[htbp!] \\centering \\includegraphics[width=12cm]{./output/Pat_see_Doc_on_expected_profit.pdf}\\\\ \\caption{Patients&#39; decision to see Doctor (get diagnosis) on expected profit} \\label{fig2} \\end{figure} 多人合作修改latex文档： 一是导言区加 \\usepackage[inline]{trackchanges} 和 \\addeditor{Tang}; 二是在latex文中加 \\note[Marian]{….} latex-caption-加上标，不用 ^, 而用 \\textsuperscript{1} 主latex文件夹下output文件夹插入： \\input{./output/filename.tex} 正文中插入数学符号需要数学环境: \\(\\theta\\) or $\\theta$ online latex: sharelatex .vs. writelatex 最后决定用writelatex， google account登录, 主要是其模板很好，可下载了自己单机用 即使是bib参考文献里面, &amp; 不能单独用, 必须是 \\&amp;, e.g. Journal of Economic Behavior \\&amp; Organization 表格 \\label 放在\\caption 后面 , 引用的时候才不会错 latex文件分割插入 \\input{} 不使用new page \\include{} 使用new page 插入pdf \\usepackage{pdfpages} \\includepdf[pages=-]{myfile.pdf} latex表格实验简介模板： \\documentclass[a4paper] {article} \\usepackage{booktabs} % \\toprule \\usepackage{multirow} % 跨行 \\usepackage{array} % 设定cell width \\usepackage{pdflscape} % \\begin{landscape} \\usepackage{longtable} \\usepackage{caption} % longtable caption center latex表格内划线： \\toprule % 划线同\\hline \\midrule \\cmidrule{2-9} % 划线2-9columns \\bottomrule %这套才是专用表格划线--上下粗，中间细 \\hline %hline划线比较难看 \\chline{2-9} latex表格cells latex表格cells内左对齐： \\multicolumn{1}{l}{文本内容} \\multicolumn{&#39;num_cols&#39;}{&#39;alignment&#39;}{&#39;contents&#39;} \\multicolumn{1}{p{2cm}}{CL} % 它要加p{} \\multirow{&#39;&#39;num_rows&#39;&#39;}{&#39;&#39;width&#39;&#39;}{&#39;&#39;contents&#39;&#39;} \\multirow{2}{2cm}{CL} % 它不加 latex表格cells内的摆中间-最好用空格调整 \\hspace{5cm} latex表格cells内的 上标 $^1$ latex表格cells内的 _ 号必须使用 \\_ latex表格cells内的 &gt; 号必须使用 \\textgreater latex表格cells内的 &lt; 号必须使用 \\textless latex表格cells内的 = 号直接使用 英文双引号–分别敲1左边键两次, 回车左边键两次: ``AAAA’’ 引用 caption{} \\label{ch:xx} % ch=chapter 即本chapter内引用，适用于PhD论文 Figure \\ref{ch:xxx} 参考文献引用： （正文中自己写，或者word和noteexpress联用产生\\cite{xxx}） \\newpage \\nocite{CurrieRossin-1756, AlmondCurrie-1194, CurrieStabile} %隐藏引用，引用从NoteExpress复制 \\bibliographystyle{alpha} %reference按字母顺序 \\bibliography{fluo.bib} %Bibtex文献数据库从NoteExpress导出题录 参考文献citation格式: \\usepackage{natbib} 一定打开格式对照图 http://www.reed.edu/cis/Help/LaTex/images/natbibA-Ncitations.png 常用其实就两种： (\\citet*{}, \\citep*{} 用于完整名字，但是根本无用) \\citet{} % text 无括号，会自动识别两个以上作者，并自动缩写 \\citep{} % 括号 (Lim and Yang et al., 2004; Tang and Zhang et al., 2014) 斜体 \\textit{} 或者 {\\it xxxx} 粗体 \\textbf{} 或者 {\\bf xxxx} 下划线 \\underline{} 页面内部调整行距 \\usepackage{setspace} \\begin{spacing}{2.0} \\end{spacing} 多个公式左对齐且无编号 \\begin{align*} &amp; equation 1 \\\\ &amp; equation 2 end{align*} \\begin{equation} \\label{eq:erl} a = bq + r \\end{equation} where \\eqref{eq:erl} is true if $a$ and $b$ are integers with $b \\neq c$. 注释有3种: 1. 用%注释一行文字; 2. 用 \\iffalse .... \\fi 注释一段文字; 3. 用 \\begin{comment} ... \\end{comment} -- 宏包\\usepackage{verbatim}. $&gt;$ ＞大于号 $\\vert$ 竖线 latex + dvipdfmx 编译的话，eps、pdf、png、jpg 都可以用 设置字体大小命令由小到大依次为： \\tiny \\scriptsize \\footnotesize \\small \\normalsize \\large \\Large \\LARGE \\huge \\Huge 横向距离 \\hspace{1cm} 纵向距离 \\vspace{1cm} 两个quad空格 a \\qquad b 两个m的宽度 quad空格 a \\quad b 一个m的宽度 大空格 a\\ b 1/3m宽度 中等空格 a\\;b 2/7m宽度 小空格 a\\,b 1/6m宽度 没有空格 ab 紧贴 a\\!b 缩进1/6m宽度 Q: 在Beamer中如果直接用pdflatex编译，则eps格式的图形无法识别，这样，一种方法是将eps转换为pdf格式。对于少量需要转换的图形，这种方法无可厚非，但是若有大量的文件需要转换，则转换调整会花费大量精力。如何直接在beamer中应用eps格式的文档呢？ A: 若直接插入eps格式到beamer中，需要通过dvi-ps-pdf形式来生成幻灯片。具体做法： 与其他tex文件一样，首先使用Texify编译源文件,得到dvi文件。 使用dvi2ps，生成ps文件。 使用ps2pdf，生成pdf文件，这也是最终需要得到的文件。 "],["r_onlinebookdashboard.html", "Chapter 3 R_Onlinebook/Dashboard 3.1 Online data collection/transfer 3.2 Building online book(Bookdown) 3.3 Building single page(robobook) 3.4 Building Dashboard(Flexboard) 3.5 Building website wt multi-pages(Blogdown)", " Chapter 3 R_Onlinebook/Dashboard 3.0.1 Docker-setting env For automation/integration, the first step is building an environment. 1. Historically, virtual machine 虚拟机是最早的带环境安装, 缺点-慢/资源多 1. Linux 发展出了另一种虚拟化技术: Linux Containers (LXC), 优点-进程级别/快, 像轻量级虚拟机 Docker是Linux容器的一种封装, 平时是一个image镜像文件, 运行时产生一个container容器文件, 给app提供接口让app像在虚拟机运行一样 - 所以一般用别人image, 从仓库(Repository, 一般为DockerHub)下载(pull)一个镜像, 加些个人设置就用 - DockerHub上比较流行R相关的两个组rstudio和rocker - 用久了, 通过编写Dockerfile来配置image - 可多个容器运行, 各容器互不影响 Docker有3种方法将数据挂载(mount)到容器: volumes容器卷，bind mounts和tmpfs mounts。一般来说，volumes总是最好的选择 5篇实操中英教程(经过筛选) - 阮一峰 - Deepnote可用docker, 但RStudio Cloud和docker冲突, RStudio Cloud本身就是一种imageRunning RStudio Server with Docker How to start using Docker 1. Docker网站下载Desktop-&gt;安装(提示装x64的Linux支持)-&gt;重启-&gt;Docker账户ctang83登录 1. 另一边, Win-&gt;cmd, 输入 - docker run --rm -p 127.0.0.1:8787:8787 -e DISABLE_AUTH=true rocker/rstudio免密登录, 用户名rstudio - docker run --rm -p 8787:8787 -e PASSWORD=xxx rocker/rstudio设密码, 用户名同上 - If setting no password before, 在Win-&gt;cmd中输入docker log xx(container name)查找, 密码随时设定 1. Docker desktop -&gt; open in browse -&gt; login in rstudio/xxx 3.0.2 Publish To create a technical description document that should be shared with other people (not be visible for everyone) - use a private GitHub repository - If you publish book to bookdown.org, there is an option that allows you to make your book private and share it with specific collaborators (this is free). RStudio directly link to two ways: RStudio Connect and Shinyapps.io - Shinyapps网站点击右上角用户名-&gt;token-&gt;copy后到RStudio publish粘贴, 本地和Shinyapps自动connect, 完成deploy - Shinyapps有9-299$ plans, 应该可以提高稳定和响应 - comparison, 直接用RStudio Connect(价格上千) Cloud Deployment for apps不难, 查了一下MQ大学没有云,但MQ网页推荐了AUS Research Data Commons 3.0.3 Shiny Shiny app主要包括两个关键组件：1) UI(user interface)前端外观; 2) server：app后台运行 simplest app.R file, or ui/server functions divided into two files library(shiny) #加载shiny包 ui &lt;- fluidPage( #定义ui，这里是一个界面显示Hello, World! &quot;Hello, world!&quot; ) #定义app如何运行，这里是空的，不做任何事情 server &lt;- function(input, output, session) { } shinyApp(ui, server) #创建并启动app 维护是一种负担，在shiny中尽量使用响应表达式(reactive expression)来精简代码, reactive expression用reactive({})封装代码并赋值给一个变量，它只在启动app的时候运行并将结果缓存 3.1 Online data collection/transfer Ideally, or the perfect situation, is that we collect and summarise data from internet, clean data, analyse data, and present outcomes online. Data infrastructure of Australia library(aurin) is “Australia’s single largest resource for accessing clean, integrated, spatially enabled and research-ready data on issues surrounding health and wellbeing, socio-economic metrics, transportation, and land-use.”. This package provides functions to download and search datasets from the AURIN API (it’s free to use!). There is an example in aurin website showing access data, obtain data through this API. R包 rvest: Easily Harvest (Scrape) Web Pages 参考手册 数据抓取两大阶段：网页获取和网页解析 R主要靠两个包，网页获取是RCurl，解析是靠XML python也对应两个包，网磁获取是requests，解析是BeautifulSoup R包 Rfacebook: 提取facebook的数据 XML(eXtensible Markup Language)可扩展标记语言, 是一种结构化数据交换语言, 可描述非常复杂的数据结构, 常用于传输和存储数据 YAML(.yml files, Yet Another Markup Language) is the metadata that tells R Markdown, pandoc, and other software exactly how to process or display the document What is the difference between YAML and JSON? YAML is a superset(超集.VS subset) of JSON 3.2 Building online book(Bookdown) This tutorial will show us easiest way to build an online book (or a book-style website) through RStudio and GitHub (may also by bookdown.org). We’ll call this book “BB”. 1) Start on local computer Copy folder “D:_template”(this version is from Jules32, much easier than Yihui’s bookdown-demo) to a reasonable place Rename 2 things from “bookdown_template” to “BB”: the folder itself the .Rproj file Double-click the .Rproj file to launch RStudio Click on the Build tab in the top right pane to build book 2) Create “BB” GitHub repo Go to your GitHub account: github.com/username Click on Repositories, and the green button “New” to create a new repo Name this new repo “BB” (DO NOT initialize this repo with a README) Click the green “create repository” button, then copy URL 3) Turn “bookdown_template” into “BB” Go back to RStudio, see your “BB” project In the Console, type usethis::use_git() and say Yes to the two prompts. This will restart R and give you a new Git tab in the upper right pane. Now, click on the Terminal tab next to the Console tab. Type git remote add origin URL Type git push --set-upstream origin master (this sentence upload files) 4) Publish “BB” (Last step) Refresh github, then files should be there! Click Settings Scroll down to GitHub Pages, click “Check it out here” Change the Source pulldown from “None” to “master branch /docs folder” It should say “Your site is ready to be published at https://username.github.io/BB/” 5) Sync/Update online book in Github Rstudio to build(knitr) the whole book, including all .Rmd files In Build panel, click “Build Book” or in Console, type rmarkdown::render_site(encoding = 'UTF-8') In Git panel, select all files, click Commit, appears a new window Input “XX changes”, click Commit Click the staged checkbox for the modified files you want to commit to GitHub repository Finally, click Push -&gt; Done! PS1: we ignore Travis and related continuous integration(持续部署) here, actually now Yihui uses Makefile and _render.R instead. PS2: Sync btw local RStudio and RStudio Cloud using Git: - because there are three copies saved in local/RStudioCloud/GitHub, if we used RStudio Cloud and sync it with GitHub, then we first need to pull/merge at local PC (commit 1), and push local changes to GitHub (commit 2). PS3: 只删除远程仓库/文件夹，不删除本地仓库/文件夹, RStudio-&gt;terminal输入 dir # 查看有哪些文件夹 git rm -r --cached target #你要删除的文件名称，这里是删除target文件夹 git commit -m &#39;删除了target&#39; # 提交,添加操作说明 git push -u origin master #重新提交（若需要对其他分支进行操作，则把master换为对应分支，如:git push -u origin dev） 6) Writing and adding chapters(.Rmd) and citations Build a new .Rmd file, name it and begin writing. As Index.Rmd is always the first chapter, we start ordering from “02-xx”. For citations, The appearance for coding chunks are different btw two types below (the second is more obvious): %%xx % %r %xx % 3.3 Building single page(robobook) In above chapter Building online book(Bookdown), multiple *.Rmd and .md files, along with a “site YAML file”(vs. YAML header), as input, a multipage website or book with internal navigation as output. (This is how the course web pages are constructed.) If we don’t need a book structure, but a single page with a structured-table(especially good for a report). We use 1) YAML header and 2) first code chunk in a single .Rmd, with outputing a single HTML. The template robobook is great for reading. --- title: &quot;啊啊啊&quot; date: &quot;2022-04-19&quot; #这个output部分在multiple .Rmd files中就是_output.yml文件 #所以 bookdown::gitbook: 对等 rmdformats::robobook: output: rmdformats::robobook: code_folding: show self_contained: true default_style: &quot;light&quot; downcute_theme: &quot;default&quot; --- #```{r setup, include=FALSE} #First code chunk setting global options #knitr::opts_chunk$set(cache = TRUE) #``` PS: Rmd has many excellent templates: rticles(journal papers), prettydoc(html), rmdformats(online book, e.g. robobook style), tufte How to insert figures? For my notebook, all figures are saved in folder /NB_tang/figs. Using codes below: ![First code chunk选项对输出的控制](figs/fig_codechunk_opt.jpg){width=100%} First code chunk选项对输出的控制 3.4 Building Dashboard(Flexboard) some definitions Rmarkdown aims to develop your code and ideas in a reproducible document Shiny package aims building interactive web applications File -&gt; New File -&gt; Shiny uses .R file Flexdashboard package aims building interactive dashboards using Rmarkdown flexdashboard像Bookdown和single page的结合, 适合展示一个topic的数据 flexdashboard是single .Rmd(用===分panel, 用—分column, 用###分box区域) .Rmd内结构也是YAML header + first code chunk flexdashboard用_site.yml as a simple site generator(基于rmarkdown, 后来发明了blogdown使用third-party site generator like Hugo) This tutorial shows us how to build an online dashboard, using flexdashboard, with RStudio and GitHub. We call this project “BB”. 1) Start on local computer Copy folder “D:_template” to a reasonable place Rename 2 things from “flexdashboard_template” to “BB”: the folder itself the .Rproj file the _site.yml -&gt; name(website) Double-click the .Rproj file to launch RStudio Click on Knit to build website .html 2) Create “BB” GitHub repo(see Building online book) 3) Turn “bookdown_template” into “BB”(see Building online book) 4) Publish “BB” (Last step) 3.5 Building website wt multi-pages(Blogdown) Blogdown use the third-party site generator, Hugo. 1) Start on local computer Copy folder “D:” to a reasonable place "],["dces-automationintegration.html", "Chapter 4 DCEs Automation/Integration 4.1 Design SP 4.2 Survey 4.3 Initiatives", " Chapter 4 DCEs Automation/Integration Design, survey and analysis pack/func Features MXL design rand exp create survey run survey formr 网站/包 rand items formr4conjoint conjointTools idefix Bayesian adaptive DCEtool local machine 包装idefix ExpertChoice 通过搜索python conjoint, 终于找到合适工具 conjointSDT.exe Conjoint Survey Design Tool一个封装好的软件应用, 能实现attribute order randomization, 但是不知道里面DCE怎么设计的?没有D-optimal conjointSDT.py是文本文件, 试试找里面att order random的代码 功能代码还是要到四件套里面找R coding 上面conjointSDT推荐的估计模型R包cjoint Pythonbiogeme, an open source freeware designed for discrete choice estimation. Kaufman has a Plos ONE and GitHub with focus on DCE ShinySurveys 文章里实现4个功能,如DCE问题随机化, 但在RStudio Cloud和RStudio都页面闪退, 因此以后网调稳定还是很重要 Jonathan Trattner has a formal R package shinysurveys aims create and deploy surveys in ‘Shiny’. 第1和第2重名但无overlap John Paul Helveston used formr.org to create a specific formr4conjoint formr利用OpenCPU和Google form, 可能更稳定 如果formr无法用, 就直接用Google Forms, which可以实现DCE的问题随机化 4.1 Design SP Basic information for this part: Orthogonal design fractional factorial design efficient design (best choice) 1. D-optimal design (optimal = maximally statistically efficient), 效率系数并非越大越好, 越大会降低choice consistency install.packages(\"idefix\") this R package combines designing DCE and dashboard implementing survey to collect data, all tasks can be conducted by using R and Github install.packages(&quot;remotes&quot;) remotes::install_github(&quot;jhelvy/conjointTools&quot;) conjointTools, designing surveys and conducting power analyses for DCE,可以D-optimal设计,安装如下 conjointTools的作者John有一门特别好的课Marketing Analytics for Design Decisions help dcreate //DCE设计Efficient designs 4.2 Survey install.packages(\"DCEtool\") A complete package for creating, surveying, and analysing DCEs on local machine, including: 1. idefix to create the exp design, and present interactive survey by Traets et al. (2020) 1. survival and mlogit to analyse results 1. new code for visual interaction dashboard 4.2.1 TO-DO-LIST randomization in displaying of attributes for each choice task 文献里叫attributes ordering effects, Randomize the attribute order, 有几种情况: (1)一个respondent加入,其n个choice set的attribute order随机化,实现难度大 (2)500个respondents,手动分2-5种attribute order版本的questionnaires, 再shuffle respondents随机进各版本 we can’t do a complete randomization of attribute order, because some attributes are ususally grouped. formr randomise items/blocks randomization of respondents across blocks, e.g. A-B-testing or experiments, oradapt question texts to sex/age 4.3 Initiatives For typical DCEs, we usually undertake the experimental design using Ngene, then hire a company such as SurveyEgine to program the survey and collect data, and finally analyse data using Stata or R. This process has several disadvantages as below: disintegrated workflow, and thus needs coordinators at different stages; generating lots of documents and files in different forms, e.g. words, excel, html files, coding files; difficult to debug when unexpected results arise; substantial costs by using external services from, e.g., Ngene and SurveyEgine. To resolve these issues, I propose an automated and integrated solution using free and open source as listed below: Step I, the project is built and synchronised between GitHub website and R local machine, and all files are using Rmarkdown language for both writing and coding; Step II, we design a simple DCE (for pilot purposes) with orthogonal main-effect arrays using “support.CEs” package in R, or we design a DCEs with Bayesian adaptive designs for the mixed logit model using idefix package in R (DCEtool包装了idefix); Step III, after generating choice sets and questionnaire, we create interactive dashboard html files using “idefix” and shiny application in R; Step IV, all files are sychronised and deployed by the GitHub, then we obtained the website link for survey and data collection (using our own database or pay a data panel provider to do it); Step V, we analyse choice data and do estimation by using either packages in R directly, or Stata coding (both inline and from a .do file) from R. "],["rstata_stated-preference.html", "Chapter 5 R/Stata_Stated Preference 5.1 Estimating models 5.2 Binary DCE(used as Case 2 BWS) 5.3 case 1 BWS", " Chapter 5 R/Stata_Stated Preference How to refer to a variable name with spaces? 答: backticks `(反引号), 如模型: RES ~Indirect payment+Direct payment`+strata ~ 符号在R里面是建立模型 Hideo Aizaki online book Non-Market Valuation with R 5.1 Estimating models case study This one using R package to estimate Willingness to Pay, Preference Share Simulator, Sensitivity Plot install.packages(\"apollo\") Coding and data examples using Apollo install.packages(\"logitr\") This package can estimate MNL and MXL, derive WTPs from Preference space and WTP space. For details, see random utility model in two spaces install.packages(\"mixl\") This R package for estimating complex choice models (MXL) on large datasets % Latent Class(潜层模型) install.packages(\"BayesLCA\") An R package for bayesian latent class analysis : Three methods for fitting the model are provided, incorporating an expectation-maximization (EM) algorithm, Gibbs sampling and a variational Bayes approximation. Stata mixed logit后计算支付意愿可用 mixlogitwtp 和 bayesmixedlogitwtp 5.2 Binary DCE(used as Case 2 BWS) 3.4.3 Organ donation部分 - Binary DCE(Lma method) BDCE可以立即用作 Case 2 BWS 这段代码是Stata中运行, 调用R包, 生成DCE原始设计med数据库(med是R中由正交表自动生成的) rsource, terminator(END_R) library(survival) library(stats) library(support.CEs) library(foreign) # for Stata dataset output % 设计DCE的attrs-levels med &lt;- Lma.design( attribute.names = list( consent = c(&quot;implicit&quot;, &quot;active&quot;), final = c(&quot;no&quot;, &quot;yes&quot;), reg = c(&quot;various&quot;,&quot;unique&quot;), quit = c(&quot;never&quot;, &quot;ask&quot;), death = c(&quot;brain&quot;,&quot;other&quot;), priority = c(&quot;no&quot;,&quot;yes&quot;), acknow = c(&quot;no&quot;,&quot;yes&quot;), payment = c(&quot;0&quot;,&quot;1w&quot;,&quot;2w&quot;,&quot;3w&quot;) ), nalternatives = 1, # create design for a BDCE nblocks = 4, row.renames = FALSE, seed = 987) % med是由上面des产生的子数据库36x11，将18个choice set分解成36个alternatives(observations), % 共11个变量(2*5+1,5个离散变量，1个连续变量)描述一个alternative attributes(med) head(med) questionnaire(choice.experiment.design = med ) data&lt;-as.data.frame(med$alternatives$alt.1) # med是list类型的对象, alt.1是attributes组合的对象 write.dta(data,&quot;d:/test.dta&quot;) # 输出BDCE attributes组合数据库 q() END_R use d:\\test.dta , clear 3.4.3 护理学生部分 Binary DCE(Lma method) BDCE可以立即用作 case 2 BWS rsource, terminator(END_R) library(survival) library(stats) library(support.CEs) library(foreign) # for Stata dataset output ################## questionnaire ############################# med &lt;- Lma.design( attribute.names = list(Place = c(&quot;Urban&quot;, &quot;Rural&quot;), Facility = c(&quot;Hospital&quot;, &quot;CHC&quot;), Mgment = c(&quot;Fsuppot&quot;, &quot;Psuppot&quot;), Material = c(&quot;Fully&quot;, &quot;Poorly&quot;), Style = c(&quot;Required&quot;, &quot;Not&quot;), Career = c(&quot;Sufficient&quot;, &quot;Limited&quot;), Income = c(&quot;2000&quot;, &quot;4000&quot;, &quot;6000&quot;, &quot;8000&quot;)), nalternatives = 1, # create design for a BDCE nblocks = 2, row.renames = FALSE, seed = 987) questionnaire(choice.experiment.design = med ) as.data.frame(med$alternatives$alt.1) # med是list类型的对象, alt.1是attributes组合的对象 % PS: 2 blocks, 16 questions in total, thus each one answer 9 questions (including one consistent test) ################## design matrix -- dm.med ############################# - Because from the above questionnaire, we can create two types of BDCE: - 1) No opt-out but include common alternative; - 2) Opt-out but no common alternative. # Here in DCE_med_spe, we choose 2). dm.med &lt;- make.design.matrix( choice.experiment.design = med, optout = TRUE, # include opt-out option categorical.attributes = c(&quot;Place&quot;, &quot;Facility&quot;, &quot;Mgment&quot;, &quot;Material&quot;, &quot;Style&quot;, &quot;Career&quot; ), continuous.attributes = c(&quot;Income&quot;), unlabeled = TRUE, # unlabeled design common = NULL, # do not include common alternative binary = TRUE) # BDCEs ################## Datasets combine: final = res + dm.med ############################# data(res) # Input respondent dataset (clean the consistent test question before input) /* res是这个格式的数据库 ID BLOCK q1 q2 q3 q4 1 1 1 1 1 0 0 2 2 2 1 0 0 1 3 3 3 1 0 0 1 4 4 4 0 1 0 0 5 5 1 0 1 0 0 6 6 2 1 1 0 1 */ final &lt;- make.dataset( respondent.dataset = res, # respondent dataset design.matrix = dm.med, # design matrix choice.indicators = c(&quot;q1&quot;, &quot;q2&quot;, &quot;q3&quot;, &quot;q4&quot;, &quot;q5&quot;, &quot;q6&quot;, &quot;q7&quot;, &quot;q8&quot;), detail = FALSE) write.dta(final,&quot;d:/test.dta&quot;) # 输出BDCE attributes组合数据库 ################## Analysis ############################# 上面部分全部调试完毕，分析部分以后做 END_R 3.4.3 医学生部分 BDCE , Lma method, BDCE可以立即用作 case 2 BWS rsource, terminator(END_R) library(survival) library(stats) library(support.CEs) library(foreign) # for Stata dataset output ################## questionnaire ############################# med &lt;- Lma.design(attribute.names = list( Place = c(&quot;Urban&quot;, &quot;Rural&quot;), Facility = c(&quot;Hospital&quot;, &quot;CHC&quot;), Mgment = c(&quot;Fsuppot&quot;, &quot;Psuppot&quot;), Material = c(&quot;Fully&quot;, &quot;Poorly&quot;), Career = c(&quot;Sufficient&quot;, &quot;Limited&quot;), Job = c(&quot;Matched&quot;, &quot;Nonmatched&quot;), Patient = c(&quot;Good&quot;, &quot;Fair&quot;), Income = c(&quot;2000&quot;, &quot;4000&quot;, &quot;6000&quot;, &quot;8000&quot;)), nalternatives = 1, # create design for a BDCE nblocks = 2, row.renames = FALSE, seed = 987) questionnaire(choice.experiment.design = med ) as.data.frame(med$alternatives$alt.1) # med是list类型的对象, alt.1是attributes组合的对象 # PS: 2 blocks, 16 questions in total, thus each one answer 9 questions (including one consistent test) ################## Matched design matrix -- dm.med ############################# # Because from the above questionnaire, we can create two types of BDCE: 1) No opt-out but include common alternative; # 2) Opt-out but no common alternative. Here in DCE_med_spe, we choose 2). dm.med &lt;- make.design.matrix( choice.experiment.design = med, optout = TRUE, # include opt-out option categorical.attributes = c(&quot;Place&quot;, &quot;Facility&quot;, &quot;Mgment&quot;, &quot;Material&quot;, &quot;Career&quot;, &quot;Job&quot;, &quot;Patient&quot;), continuous.attributes = c(&quot;Income&quot;), unlabeled = TRUE, # unlabeled design common = NULL, # do not include common alternative binary = TRUE) # BDCEs ################## Datasets combine: ds.med = medspe + dm.med ############################# data(medspe) # Input respondent dataset (clear the consistent test question before input) ds.med &lt;- make.dataset( respondent.dataset = medspe, # respondent dataset design.matrix = dm.med, # design matrix choice.indicators = c(&quot;q1&quot;, &quot;q2&quot;, &quot;q3&quot;, &quot;q4&quot;, &quot;q5&quot;, &quot;q6&quot;, &quot;q7&quot;, &quot;q8&quot;), detail = FALSE) head(ds.rural1) # list head of the final dataset ################## Analysis 上面部分全部调试完毕，分析部分以后做 ############################# fm.rural &lt;- RES ~ Agr + Env + Rec + Area + Tax out.rural1 &lt;- glm(fm.rural, # is glm() the clogit in Stata ? family = binomial(link = &quot;logit&quot;), data = ds.rural1) summary(out.rural1) gofm(out.rural1) out.rural2 &lt;- glm(fm.rural, family = binomial(link = &quot;logit&quot;), data = ds.rural2) summary(out.rural2) gofm(out.rural2) mwtp.rural1 &lt;- mwtp(output = out.rural1, monetary.variables = c(&quot;Tax&quot;), nonmonetary.variables = c(&quot;Agr&quot;, &quot;Env&quot;, &quot;Rec&quot;, &quot;Area&quot;), nreplications = 1000, confidence.level = 0.95, method = &quot;kr&quot;, seed = 987) mwtp.rural1 mwtp.rural2 &lt;- mwtp(output = out.rural2, monetary.variables = c(&quot;Tax&quot;), nonmonetary.variables = c(&quot;Agr&quot;, &quot;Env&quot;, &quot;Rec&quot;, &quot;Area&quot;), nreplications = 1000, confidence.level = 0.95, method = &quot;kr&quot;, seed = 987) mwtp.rural2 str(mwtp.rural1$mwtps) MWTP_Rec1 &lt;- mwtp.rural1$mwtps[, &quot;Rec&quot;] MWTP_Rec2 &lt;- mwtp.rural2$mwtps[, &quot;Rec&quot;] mded.rec &lt;- mded(distr1 = MWTP_Rec1, distr2 = MWTP_Rec2, detail = TRUE) mded.rec par(mfrow = c(1, 2)) # not shown in SPMUR hist(mded.rec$diff, main = &quot;(a) Rec&quot;, xlab = &quot;Difference&quot;) MWTP_Area1 &lt;- mwtp.rural1$mwtps[, &quot;Area&quot;] MWTP_Area2 &lt;- mwtp.rural2$mwtps[, &quot;Area&quot;] mded.area &lt;- mded(distr1 = MWTP_Area1, distr2 = MWTP_Area2, detail = TRUE) mded.area hist(mded.area$diff, main = &quot;(b) Area&quot;, xlab = &quot;Difference&quot;) v0 &lt;- 0 Plan1 &lt;- c(1, 0, 0, 0, 20, 0) v1 &lt;- sum(out.rural1$coef * Plan1) (-1 / -out.rural1$coef[&quot;Tax&quot;]) * (v0 - v1) Plan2 &lt;- c(1, 1, 0, 0, 60, 0) v2 &lt;- sum(out.rural1$coef * Plan2) (-1 / -out.rural1$coef[&quot;Tax&quot;]) * (v0 - v2) set.seed(123) COEF &lt;- mvrnorm(out.rural1$coef, # coefficients vcov(out.rural1), # variance-covariance n = 1000) # number of replications V0 &lt;- rep(0, 1000) V1 &lt;- COEF %*% Plan1 # %*% is matrix multiplication C1 &lt;- (-1 / -COEF[, &quot;Tax&quot;]) * (V0 - V1) V2 &lt;- COEF %*% Plan2 C2 &lt;- (-1 / -COEF[, &quot;Tax&quot;]) * (V0 - V2) hist(C1, main = &quot;Case 1&quot;, xlab = &quot;Compensating variation&quot;) hist(C2, main = &quot;Case 2&quot;, xlab = &quot;Compensating variation&quot;) quantile(C1, c(0.025, 0.975)) quantile(C2, c(0.025, 0.975)) (-1 / -out.rural1$coef[&quot;Tax&quot;]) * (log(exp(v0) + exp(v1)) - log(exp(v0) + exp(v2))) par(mfrow = c(1, 1)) # not shown in SPMUR C3 &lt;- (-1 / -COEF[ ,&quot;Tax&quot;]) * (log(exp(V0) + exp(V1)) - log(exp(V0) + exp(V2))) hist(C3, main = &quot;&quot;, xlab = &quot;Compensating variation&quot;) quantile(C3, c(0.025, 0.975)) 5.3 case 1 BWS Two methods for constructing choice sets for case 1 BWS: OMED - two level orthogonal main-effect design BIBD - blanced incomplete block design (每题的number of items固定，所以建议只用这种)BIBD 可用的difference set如下 find.BIB(trt = 16, k = 6, b = 16 ) find.BIB(trt = 15, k = 7, b = 15 ) find.BIB(trt = 13, k = 4, b = 13 ) # 11 or 13 items is the best! find.BIB(trt = 11, k = 5, b = 11 ) find.BIB(trt = 10, k = 4, b = 15 ) find.BIB(trt = 9, k = 3, b = 12 ) find.BIB(trt = 8, k = 4, b = 14 ) find.BIB(trt = 7, k = 3, b = 7 ) find.BIB(trt = 6, k = 3, b = 10 ) # 总共6个items，10 个问题，每个问题3个items ########### 用于7，9,11个items的case 1 BWS items &lt;- c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;) items &lt;- c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;) items &lt;- c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;) Organ donation - Results analysis by R (all output in D:) , 所有结果输出都Stata化了, 只需要解决第2部分Create dataset: “final” = res + bibd rsource, terminator(END_R) ####################### 下面是成熟的针对13个items的程序，只需加载第2部分的新res数据库（res是来自调查的数据） library(DoE.base) library(crossdes) # crossdes package中的 find.BIB函数产生BIBD设计 library(support.BWS) library(survival) library(foreign) ########################################################### %%% 1. Constructing choice sets &amp; Case 1 BWS questions (BIBD) - organ donation 器官捐献量表 ########################################################### set.seed(123) bibd &lt;- find.BIB(trt = 13, k = 4, b = 13) # BIBD设计 isGYD(bibd) # 此函数检查 trt，k，b 搭配是否平衡 %View(bibd) items &lt;- c(&quot;Media&quot;, &quot;Religion&quot;, &quot;Tradition&quot;, &quot;Legislation&quot;, &quot;Family&quot;, &quot;Experience&quot;, &quot;Self-decision&quot;, &quot;Consent&quot;, &quot;Withdrawal&quot;, &quot;Death&quot;, &quot;Allocation&quot;, &quot;Indirect payment&quot;, &quot;Direct payment&quot;) %接下来两步走，准备问卷和创建final数据库是独立的， %%% 1). Preparing BWS questions # design.type = 2 means BIBD % bws.questionnaire(choice.sets = bibd, design.type = 2, item.names = items ) %%% 2). Create dataset &quot;final&quot; = res + bibd res&lt;-read.dta(&quot;D:/desk/Googledrive/fj_phs/data/res.dta&quot;) final &lt;- bws.dataset(respondent.dataset = res, response.type = 1, # row number format choice.sets = bibd, design.type = 2, # BIBD item.names = items) write.dta(final,&quot;d:/BWS_final.dta&quot;) %View(final) # list dat 数据库，此数据库是最终用于分析的库 ########################################################### %%% 2. Analyzing responses using &quot;The Counting Approach&quot; (output: 3 graphs) % two tables: 1.Disaggregated best-worst scores &amp; 2.Aggregated best-worst scores % 表1,2的关系是，表1所有系数乘以n (n是被调查人数) % PS: 分析部分需要Stata化，R的分析完全没有过程！ ########################################################### scores &lt;- bws.count(data = final) scores scores$aggregate data&lt;-as.data.frame(scores$aggregate) # med是list类型的对象, alt.1是attributes组合的对象 write.csv(data,&quot;d:/tab_BWS_aggregate_score.csv&quot;) # 这个表待会读入Stata，然后转成Latex表 %%%%% Figure 1 Distribution of simple BW scores by items BW &lt;- data.frame(scores$disaggregate$BW) BW &lt;- lapply(BW, factor, levels = c(-4:4)) # scores are transformed into a factor score.tables &lt;- lapply(BW, table) # table for each item ylimit &lt;- max(unlist(score.tables)) # max count among items pdf(&quot;d:/fig_BWS_bars_items.pdf&quot;) # open .pdf for output par(mfrow = c(4,4)) # create 4 x 4 figure regions, otherwise alarm of &quot;out of figure margin&quot; for(i in 1:13){ # draw graph for item 1-13 barplot(height = score.tables[[i]], main = items[i], # title xlab = c(&quot;BW score&quot;), # label for x-axis ylab = c(&quot;Count&quot;), # label for y-axis ylim = c(0, ylimit)) # limits for y-axis } dev.off() # output graph with pdf type %%%%%% Figure 2 Relationship between the mean BW score and its standard deviation Mean.BW &lt;- colMeans(scores$disaggregate$BW) Standard.Deviation.BW &lt;- apply(scores$disaggregate$BW, 2, sd) pdf(&quot;d:/fig_BWS_mean_SD.pdf&quot;) plot(x = Mean.BW, y = Standard.Deviation.BW, xlim = c(-3, 3), ylim = c(1, 2)) text(x = Mean.BW, y = Standard.Deviation.BW, pos = 4, labels = items) dev.off() %%%%%% Figure 3 Mean BW score per item in each cluster set.seed(123) kmeans &lt;- kmeans(x = scores$disaggregate$BW, centers = 2) kmeans$centers pdf(&quot;d:/fig_BWS_mean_ranking.pdf&quot;) barplot(height = kmeans$centers, names.arg = items , beside = TRUE, # draw juxtaposed bar legend = c(&quot;cluster.1&quot;, &quot;cluster.2&quot;), horiz = TRUE, las = 2, xlab = &quot;BW score&quot;, xlim = c(-4, 4)) dev.off() END_R 读入tab_BWS_aggregate_score.csv 然后用mata转成Latex表 import delim using &quot;d:\\tab_BWS_aggregate_score.csv&quot; , clear gen att_id=_n rename v1 att_name order att_id , b(att_name) * tex output texsave _all using &quot;d:\\tab_BWS_aggregate_score.tex&quot; , frag replace /// title(Aggregated best-worst scores) /// footnote(Note: The number of respondents is 190) Analyzing responses using the modeling approach use &quot;d:\\final.dta&quot; , clear fr &lt;- RES ~ A + B + C + E + F + G + H + I + J + K + L + M + strata(STR) % the model exclude D to normalize its coefficient to 0 clogit(formula = fr, data = dat) "],["r.html", "Chapter 6 R 6.1 Workflow/Reproducible research 6.2 Plot/graph/visualisation 6.3 Data 6.4 Install R/RStudio", " Chapter 6 R R资源汇总 An updating online-book R for Data Science, 搜关键词 Databases using R RStudio 精选包: - Analyse &amp; Explore: tidyverse(dplyr数据框 tidyr等价Stata), ggplot2, purrr函数, stringr字符 - Model &amp; Predict: TensorFlow, tidymodels, Sparklyr - Communicate &amp; Interact: shiny, Rmarkdown, flexdashboard - Connect &amp; Integrate: Sparklyr(interface to Apache Spark), Plumber(create API), reticulate(interface to Python) PS: Apache Spark is an open-source unified analytics engine for large-scale data processing 6.1 Workflow/Reproducible research Automate builds with ghactions, which will replace other continuous integration(CI) tools like Travis, Jenkins. GitHub actions just requires a special file in a special directory at the root of your repository to work: .github/workflows/main.yml. To quickly set up such a file for frequently used project kinds, run: #remotes::install_github(&quot;maxheld83/ghactions&quot;) #install ghactions::use_ghactions(workflow = ghactions::website()) Why do we need notebook interface(笔记本界面)? A:human–computer interaction人-机交互可以理解为人-信息交互, 如下有多种方式, 但最好的中间载体是一个笔记本界面notebook interface(文学编程literate programming), which input 文本、代码、公式、图片、数据、PDF, while output HTML, PDF, DOC, dashboard and so on. Some major human-computer interfaces as below: 1 Text-based user interface, e.g. Command-line interface -&gt; notebook interface 2 Graphical user interfaces (GUIs) VS. Sonic user interface 3 Natural language user interface 4 Tangible user interface, e.g. Touch user interface Rmd网上有很多模板可用包安装, 如“stevetemplates”, File-&gt; New File-&gt; R Markdown-&gt;From templates增加了很多新模板 R Markdown(脚本文本)比Latex好得多，生成PDF, word, html, slides R Shiny (脚本文本交互), 都可以通过github下载各种templates 名词比较混 Markdown (markup language): a “lightweight” markup language (like HTML) Markdown (R package): the predecessor of rmarkdown, converts .Rmd files into HTML R Markdown (R package): 包括两个小包 rmarkdown and knitr R Markdown (markup language): .Rmd file that is an excellent “literate programming” and “reproducible research” Knitr converts .Rmd -&gt; .md .Rnw(Sweave) -&gt; .tex .Rhtml -&gt; .html After Knitr works, then Pandoc converts md/tex/html into various formats as PDF/HTML/Word/. 数字下面插入小点, 空两个tab键 1. Rename 2 things from &quot;bookdown_template&quot; to &quot;BB&quot;: - the folder itself - the .Rproj file 6.2 Plot/graph/visualisation install.packages(“geofacet”) facet小平面, 组成”嵌入变量内容”的地理拼图. The main function in this package is facet_geo() and its use can be thought of as equivalent to ggplot2’s facet_wrap() except for the output it creates. The facet_geo() works just like ggplot2’s built-in faceting. library(geofacet) library(ggplot2) head(state_ranks) get_grid_names() %% geofacet自带多国多地图 head(aus_pop) %% Geofacet - Australian population by age group ggplot(aus_pop, aes(age_group, pop / 1e6, fill = age_group)) + geom_col() + facet_geo(~ code, grid = &quot;aus_grid1&quot;) + coord_flip() + labs( title = &quot;Australian Population Breakdown&quot;, caption = &quot;Data Source: ABS Labour Force Survey, 12 month average&quot;, y = &quot;Population [Millions]&quot;) + theme_bw() Install.packages(“Shinytableau”) Create Tableau(所有方面比Power BI好的拖动式画图软件) Dashboard Extensions With R Shiny(脚本文本交互) Install.packages(“lattice”) % focus on multivariate data, and in particular to produce “small multiple” plots 画图 和 输出图片, 分辨率dpi和tiff压缩随便调 pdf(&quot;d:/xx.pdf&quot;) ...省略画图命令... dev.off() // now output tiff(600dpi) tiff(file = &quot;C:/test1.tiff&quot;, res = 600, width = 4800, height = 4800, compression = &quot;lzw&quot;) plot(1:22, pch = 1:22, cex = 1:3, col = 1:5) #绘图命令在中间 dev.off() 6.3 Data 输入数据 c() #Combine Values into a Vector or List M &lt;- vector(length=8) #vector函数优点是先定义长度，如8，再赋值 read.table() #读取txt文件 输出数据，需要library(foreign) write.dta(data,&quot;d:/test.dta&quot;) # 输出Stata12数据库 write.csv(desmat, file = &quot;D:/desk/UNSW/DCE/haze_desmat.csv&quot;) # csv是常用格式 rbind(a1,a2) # rows bind 堆积 cbind(a1,a2) # column 并列 读写 xls 和 xlsx 格式有几个包可以做到： xlsx / XLConnect 控制流 分支： if(condition){}/else if(condition){} /else{} 循环： for(name in expr_1){ expr_2} | while(condition){expr} | repeat { expr;break } 中止语句：break 空语句： next 矩阵 A &lt;- matrix(1:15,nrow=2,ncol=4,byrow=TRUE) #默认是按列, 此时A是int整数型 A [,1] [,2] [,3] [,4] #用[1,]和[,1]表示行列 [1,] 1 2 3 4 [2,] 5 6 7 8 cell &lt;- c(3,5,4,5,6,1,1,4,6,7) A &lt;- matrix(cell,nrow=2,ncol=4,byrow=TRUE) #此时A是numeric数据型 x&lt;-1:5; y&lt;-2*1:5 #冒号优先,故是2 4 6 8 10向量 crossprod(x,y) #求内积,结果是单值110 outer(x,y) #求外积,结果是5x5方阵 t(x) #矩阵x转置transpose A&lt;-array(1:9,dim=(c(3,3))) #arrays 阵列；数组 B&lt;-array(9:1,dim=(c(3,3))) A*B #区别一:各对应元素相乘 A%*%B #区别二:矩阵乘法 crossprod(A,B) #区别三:等价t(A)%*%B 可对矩阵某维或者若干维进行运算：apply(M,某维,FUNction)。例：A&lt;-matrix(1:6,nrow=2);apply(A,1,sum) x[-3] #显示除第3个以外的其他值 x[c(3,5)] #显示x的第3和第5个值 sort(x) #按顺序排列，显示数据 order(x) #按顺序排列，显示下标 X1 &lt;- c(21.3, 19.9, 22.4, 24.1, 25.9) X2 &lt;- c(32.1, 27.8, 30.1, 29.9, NA) #最后一个缺失值，mean(X2)就算不出来，只能mean(X2,na.rm=TRUE) is.na(X2) #显示哪一位值是缺失？ ID &lt;- rep(1:4,each=8) #rep()产生32个重复数，另有 seq(1, 9, by = 2) 类似rep() ID &lt;- rep(c(&quot;X1&quot;,&quot;X2&quot;,&quot;X3&quot;),c(3,2,1)) #重复不同次数 向量 .VS. 因子 简单讲：因子是一个点用于存储分类(categorical)数据，向量是一个有方向的范围。 在R中，如果把数字作为因子，那么在导入数据之后，需要将向量转换为因子（factor），而因子在整个计算过程中不再作为数值，而是一个”符号”而已。 因子操作： 把一个向量编码为一个因子：factor() 因子的水平（感觉像是不同的值）：levels() 各类数据的频数：table() 操作对象 是否为数值：is.numeric(X) 是否为字符：is.character(X) 类型转换： as.character(X), as.numeric(X) 改变长度： length(X)&lt;-新长度。用空值填充或去掉多的 返回对象的属性：attributes(object) 存储对象的属性：attr(object,”属性名”) 探索R对象 mode(x) #对象类型： dim(x) #对象的两维度 length(x) #对象个数 e.g. 对象d.med是list mode(d.med) length(d.med) attributes(d.med) head(d.med) dd&lt;-as.data.frame(d.med$nalternatives$alt.1) #d.med里有个数据库，提取出来放到数据库dd里面去 R三种对象类型 R没有标量 一、向量（X） assign(向量名, X); 向量名&lt;- X; X -&gt;向量名; #赋值 paste(X,Y) #字符型向量,字符串连接 complex() #复数向量 二、数据框 data frame--多个向量组成的二维数据库（类矩阵） // 数据框其实就是Stata下的数据库，矩阵要求全是数字，数据框每列可以是不同的mode data.frame() #构造数据框 as.data.frame() #转换为数据框 attach() # attach()能不用就不用，最好是哪里都不用，如果你非觉得它方便，那么我的建议还是不要用——用with() detach() #数据框加属性 Dfm$We #数据框Dfm中寻找We变量，$(dollar符号,表at访问) DataAll &lt;- list(Bird=bid.8, ID=ID, Z=Z) #list函数中只能用&quot;=&quot;,不能用&quot;&lt;-&quot; 三、列表 list--包含任何类型的对象 构造：list() attach()用法 用$ 符号访问对象不是非常的方便，如accountants$statef 如果键入命令attach(accountants)，那你就可以直接用accountants里的变量， 列表 列表的分量可以是不同的类型，使用list()函数可以创建列表： &gt; x = list(name=&quot;Fred&quot;, wife=&quot;Mary&quot;, no.children=3, child.ages=c(4,7,9)) &gt; x $name [1] &quot;Fred&quot; $wife [1] &quot;Mary&quot; $no.children [1] 3 $child.ages [1] 4 7 9 列表元素可以通过几种不同的索引进行访问： &gt; x[[1]] [1] &quot;Fred&quot; &gt; x[1][1] $name [1] &quot;Fred&quot; &gt; x[&quot;name&quot;][1] $name [1] &quot;Fred&quot; &gt; x$name [1] &quot;Fred&quot; 数据框 &gt; L3 = LETTERS[1:3] &gt; L3 [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &gt; d = data.frame(cbind(x = 1, y = 1:10), fac = sample(L3, 10, replace = TRUE)) &gt; d x y fac 1 1 1 B 2 1 2 A 3 1 3 C 4 1 4 C 5 1 5 B 6 1 6 A 7 1 7 A 8 1 8 B 9 1 9 B 10 1 10 A &gt; d$x [1] 1 1 1 1 1 1 1 1 1 1 &gt; d[[2]] [1] 1 2 3 4 5 6 7 8 9 10 &gt; d[1][1] x 1 1 2 1 3 1 4 1 5 1 6 1 7 1 8 1 9 1 10 1 6.4 Install R/RStudio installr:: A nice function in RStudio to install everything installr::install.Rtools() # Rtools always required installr() # 弹出对话框,很多软件 升级Rstudio Rstudio is IDE of R, needs setup of R before. Rstudio-&gt;tools-&gt;Global options-&gt;R路径 升级R, 安装所有packages install.packages(c(“apollo”, “arm”, “backports”, “BayesLCA”, “bibtex”, “bit”, “bit64”, “bitops”, “BMA”, “bookdown”, “brio”, “caret”, “caTools”, “cli”, “colorspace”, “curl”, “data.table”, “deSolve”, “devtools”, “diffobj”, “digest”, “dotCall64”, “dplyr”, “e1071”, “effects”, “ellipsis”, “expm”, “fansi”, “farver”, “fastmap”, “fields”, “fs”, “geofacet”, “gert”, “git2r”, “glue”, “gmp”, “gower”, “gsynth”, “haven”, “hdrcde”, “Hmisc”, “htmltools”, “httpuv”, “ipred”, “isoband”, “installr”, “jpeg”, “jsonlite”, “ks”, “later”, “latticeExtra”, “lfe”, “lme4”, “lmtest”, “lubridate”, “magick”, “magrittr”, “maps”, “maptools”, “Matrix”, “matrixStats”, “mclust”, “MCMCpack”, “memisc”, “mime”, “mnormt”, “msm”, “multicool”, “mvtnorm”, “nloptr”, “openssl”, “partitions”, “pcaPP”, “pkgload”, “pROC”, “processx”, “promises”, “proxy”, “ps”, “quantreg”, “randtoolbox”, “rappdirs”, “Rcpp”, “RcppArmadillo”, “RcppEigen”, “RCurl”, “readr”, “readstata13”, “rgl”, “rJava”, “rlang”, “rngWELL”, “robustbase”, “RODBC”, “roxygen2”, “rrcov”, “sass”, “sem”, “shiny”, “slam”, “sp”, “spam”, “SparseM”, “statmod”, “stringi”, “sys”, “testthat”, “tibble”, “tidyr”, “tidyverse”, “tis”, “utf8”, “vctrs”, “VGAM”, “VGAMdata”, “vroom”, “XLConnect”, “XML”, “xml2”, “zip”, “zoo”)) 安装加载搜索包 install.packages(&quot;support.CEs&quot;) #support.CEs是一个设计DCE的package，本函数还自动下载附加支持包 install.packages(&quot;包名字&quot;,lib=&quot;安装目录&quot;,repos=&quot;包所在的网址&quot;) search() #查看现在已经读取的扩展包 detach(”package:扩展包名”) #卸载某个扩展包 data() #查看当前可使用的数据对象 data(package = “扩展包名”) #查看在该扩展包中的数据对象 .libPaths() #查看library安装路径 默认情况下，help只会载入内存包中搜索，try.all.package=TRUE 可以在全包中搜索 &gt;help(bs,try.all.package=TRUE); #会显示出对应的包 Package Library splines E:\\work\\R\\library &gt;help(bs,package=&quot;splines&quot;); &gt;help.search(&quot;tree&quot;); #搜索所有包含tree的api 求助符、帮助 ?plot #函数打一个问号 , or help(plot) ??vegan #包两个问号 help.search(&quot;rnorm&quot;) # search help files, even wrong spelling args(&quot;rnorm&quot;) # get arguments参数 RSiteSearch(&quot;discrete choice experiment&quot;) #搜索网站（不是搜索本地计算机目录） 查看源代码 对于普通的函数——function，可以直接键入函数名就可以在console中看到源代码了，比如： &gt;damnN 有些类函数需要先用methods()函数看看都有什么，再一点一点的查看。 比如查看summary中的aov命令源代码： &gt;methods(summary) &gt;summary.aov 管理IO环境 object.size #检查对象使用的内存 setwd(&quot;D:/R/DCE&quot;) #设置工作文件夹 getwd() #来查看当前目录working directory dir() #查看当前目录里的文件 Console清屏： ctrl+L semi-colon (;) to put multiple statements on one line 一行多句命令 认识包 Type library()就知道已经有什么packages了 Type library(survival) 加载包,包里经常有数据 Type data()就知道有什么数据，注意:R语言对大小写敏感 PATH设置报错-待解决? A: 同步导致的，希望早点升级R源程序 &gt; Sys.getenv(&quot;PATH&quot;) Warning message: In normalizePath(path.expand(path), winslash, mustWork) : path[1]=&quot;D:/????&quot;: The filename, directory name, or volume label syntax is incorrect "],["stata.html", "Chapter 7 Stata 7.1 Debug问题集 7.2 Modelling 7.3 Plot/graph/visualisation 7.4 EDA探索性分析 7.5 Connection 7.6 Data/Big data", " Chapter 7 Stata 基于putdocx的4个命令： reg2docx, sum2docx, t2docx，corr2docx help cfvars 文件1 文件2 //自动比较两个数据库的变量 labelbook //列所有标签 findname //List variables matching name patterns or other properties ssc install mkduration //create duration variables in binary cross-sectional time-series data notes: xxxx //把xxxx加到当前dta gsort +xx 或者 -xx //排序时sort只能一个方向，gsort可以两个 by group,sort: sum age //按组group统计age gen no=_n //编号 browse if oops&gt;1 //窗口查看,替代list命令 cap noisily reg y x //声明错误,但程序继续运行完 viewsource XXX.ado //看源程序 f(%3.2f) //小数点后两位数格式 duplicates drop XXX, force //删除重复values检测 clonevar newvar = varname //复制创建新变量, var label和value label也一起复制过去 7.1 Debug问题集 set trace on //debug set trace off 粘贴导入excel数据库时，遇到不将first row treat as var name原因：1. 第一行变量名有空格，2. 或用了long等Stata保留词 用tab icd10遇到unique值太多的时候，又只想看频率最多的前10个 groups icd10, order(h) select(10) groups xx , saving(tab1, replace) //生成唯一值表，用于合并 help icdpic //处理ICD 9-10 命令族, 最下面有一系列Also see missing data 缺失值/数据 mdesc _all //关注缺失组和整体组的核心变量是否有显著性差异, 以此简单判断-缺失是否具有选择性 fmiss varlist, detail 把缺失值转换成数值，以便于数据的各种转换 mvencode _all, mv(999) //Translate missing values in the data to 999 mvdecode _all, mv(999) //Change 999 values back to missing values Stata 多个变量找缺失值 egen nmis=rmiss2(landval improval totval salepric saltoapr) tab nmis //4个obs没有缺失值, 9个obs有1个缺失值 http://www.ats.ucla.edu/stat/stata/faq/nummiss_stata.htm 合并/match/merge/系列命名dta qui fs xx.dta //先list文件名，存进r(files) foreach f in `r(files)&#39; { qui append using `f&#39; } - 3个命令模糊match or fuzzy merge: reclink 2010 strgroup 2012 , 使用了merge后,针对_merge==3用strgroup nearmrg 2012 tempfile master part1 // 使用 save &quot;`master&#39;&quot; , replace append using &quot;`part1&#39;&quot; mmerge //多文件匹配 levelsof varname [if] [in] [, options] // 显示变量values,并排序levels //e.g.按每个变量值（880种病）导出 cd &quot;d:\\icd&quot; levelsof icd10c , local(levels) qui foreach l of local levels { export excel using &quot;`l&#39;.xlsx&quot; if icd10c==&quot;`l&#39;&quot; , first(var) replace drop if icd10c==&quot;`l&#39;&quot; } //e.g. sysuse auto replace make=substr(make, 1, 4) levelsof make , clean separate(;) local(make) matcell(freq) display &quot;`make&#39;&quot; matrix l freq 数出每个单位有几个医生spe&lt;4，赋值给各单位医生数变量pn。其a和b是中间产生的变量。 gen a=1 if spe&lt;4 bysort org: replace pn=sum(a) if spe&lt;4 bysort org: egen b=max(pn) //egen是bysort org全部加总 bysort org: gen b=max(pn) //gen是逐个加总 replace pn=b drop a b //另一方法:用egen egen abc=group(date hour shi) egen racesex=group(race sex) //racesex 交叉组, and containing missing if race or sex are missing egen zong=noccur(c),s(&quot;,&quot;) //counting number of times a string appears in the variable某字符在变量中出现的次数 egen store_occupy_mean_price=mean(price) , by(store_id occupy_id) egen f_dropout_kids_only=count(student_id) if f_edu&lt;12, by(school) egen f_dropout_kids_only=tag(student_id) if f_edu&lt;12, by(school) //create dummy var egen g=group(x) sum g list r(max) 7.2 Modelling help simex // 做policy simulation，还有help simexplot help meta //元分析Stata-summary estimates Forest plot of study-specific estimates 合并效应值的森林图 coefplot – plotting regression coefficients and other estimates 转平衡面板from unbalanced to balanced encode hosid , gen(hid) //字符hosid转数值hid xtset hid ym //定义面板 hosid ym xtpatternvar, gen(pattern) //转平衡面板 codebook patt fre patt , as 分析幂律, 私人组件 powerlaw（已装） http://coin.wne.uw.edu.pl/mbrzezinski/software doedit example.do //使用powerlaw，没有help文件，但有例子example.do 见NoteExpress： Brzezinski, M. 2014. Do wealth distributions follow power laws? Evidence from `rich lists&#39;. Physica A 406: 155-162. - Fitting Data into Power Distribution: Estimating alpha and x0. It&#39;s not a matter of estimating the 2 parameters together in one step Fit your model using -paretofit- for multiple thresholds over a plausible range, and from this, calculate the K-S statistics. * 分析分布 help pwlaw //基于一个变量，计算power统计量Stata journal D:\\aa\\LITERATURE\\POOL-2014\\10.1177@1536867X20953571.pdf help qplot //有power law, 见NoteExpress：Speaking Stata: The protean quantile plot. Stata Journal, 2005. 5(3): p. 442-460. help distplot //Do wealth distributions follow power laws? D:\\aa\\LITERATURE\\分级诊疗-自科\\幂律和zipf\\brzezinski2014.pdf - R poweRlaw: Analysis of Heavy Tailed Distributions zero inflated regression (most Y zero) help zinb //Zero-inflated negative binomial regression (Y is a nonnegative count var) help zip //Zero-inflated Poisson regression Durbin–Watson test 自相关autocorrelation检测 estat dwatson // Performs Durbin-Watson test of residual autocorrelation following regress. The data must be tsset 因为自相关系数ρ的值介于-1和1之间，所以 0≤DW≤４ DW＝ O ＜＝＞ ρ＝１ 即存在正自相关性 DW＝４ ＜＝＞ ρ＝-１ 即存在负自相关性 DW＝２ ＜＝＞ ρ＝０ 即不存在（一阶）自相关性 因此，当DW值显著的接近于O或４时，则存在自相关性，而接近于２时，则不存在（一阶）自相关性。 logit回归，输出表格以Odds ratio (OR) 即 exponentiated coefficient形式加z检验系数（eform）或输出 Confidence Interval (CI), esttab urban urbanfe $usertf , $tab replace nonum mtitles(&quot;Logit model&quot; &quot;Logit model with FE&quot;) /// cells(b(star fmt(%9.3f)) ci(par)) keep(2.edu 3.edu age gender) eform z 经过比较后,感觉很好的输出格式: (但, eform表示mlogit输出RRR-自然对数, tex输出Latex格式) esttab m2 , drop(o.* 1b.* 2o.* 3o.* 4o.*) [eform] unstack replace [tex] /// cells(b(star fmt(%9.3f)) se(par)) starlevels(* 0.10 ** 0.05 *** 0.01) /// stats(N chi2 bic, star(chi2) fmt(%9.0g %9.3f)) varlabels(_cons Constant) 如果输出 margins margins, dydx(_all) post // post option that tells margins to leave the results behind as if it were an estimation command esttab using x.tex, label esttab , r2 ar2 pr2 //可以调出显示model的R2，Adj-R2，Pseudo-R2 FE固定效应 大于2-level fixed effect in one model： egen industry_firm=group(industry firm) // or more FE var 方法一 regress y x1 x2 x3 x4 i.industry_firm 方法二 areg y x1 x2 x3 x4, absorb(industry_firm) // 交叉项产生2-level FE，8x9type=72 个dummies 方法三(可2个以上dummy变量) aareg y x1 x2 x3 x4, absorb(industry firm) // 分开不等于交叉项， 8+9type=17 个dummies areg -- Linear regression with a large dummy-variable set tabulate province,gen(dumy) // 就可以产生dumy1－dumy31变量， reg y x1 x2 dumy2-dumy31 // 或者不产生，在回归的时候用xi命令 xi: reg y x1 x2 i.province Stata已经发展了一套”截断时序回归”命令 `help itsa help itsamatch help itsaperm help regcheck //同时检验所有回归假设 标记参与了回归的样本 reg price rep78 weight length foreign gen esample=1 if e(sample) //标记参与了回归的样本 su price rep78 weight length foreign if esample==1 event study事件研究 help eventdd //画图特别好 其他命令 estudy eventstudy eventstudy2 help eventstudy2 处理多期的一般DID, for causal analysis with varying treatment time and duration help flexpaneldid help flexpaneldid_preprocessing help bacondecomp //Bacon decomposition of DID estimation with variation in treatment timing help forecast // a suite of commands for obtaining forecasts/projection by solving models 小聪的DID命令 webuse nlswork //使用系统自带数据库 xtset idcode year, delta(1) //设置面板 xtdescribe //描述一下这个面板数据情况 gen age2= age^2 gen ttl_exp2=ttl_exp^2 gen tenure2=tenure^2 global xlist &quot;grade age age2 ttl_exp ttl_exp2 tenure tenure2 not_smsa south race&quot; sum ln_w $xlist //统计描述相关变量 **DID方法----------------------------------- gen time = (year &gt;= 77) &amp; !missing(year) //政策执行时间为1977年 gen treated = (idcode &gt;2000)&amp;!missing(idcode) //政策执行地方为idcode大于2000的地方 gen did = time*treated //这就是需要估计的DID，也就所交叉项 reg ln_w did time treated $xlist //这就是一个OLS回归，也可以用diff命令 xtreg ln_w did time treated $xlist i.year, fe //也可以这去做，会省略掉一个虚拟变量 **PSM-DID方法------------------------------- ** PSM的部分 set seed 0001 //定义种子 gen tmp = runiform() //生成随机数 sort tmp //把数据库随机整理 psmatch2 treated $xlist, out(ln_w) logit ate neighbor(1) common caliper(.05) ties //通过近邻匹配，这里可以要outcome，也可以不要它 pstest $xlist, both graph //检验协变量在处理组与控制组之间是否平衡 gen common=_support drop if common == 0 //去掉不满足共同区域假定的观测值 psgraph ** DID的部分，根据上面匹配好的数据 reg ln_w did time treated $xlist xtreg ln_w did time treated $xlist i.year, fe **PSM-DID部分结束-------------------------------------- *交互项 help xi **DID方法需要满足的五个条件检验------------------------ **1.共同趋势假设检验 tab year, gen(yrdum) //产生year dummy，即每一年一个dummy变量 forval v=1/7{ gen treated`v&#39;=yrdum`v&#39;*treated } //这个相当于产生了政策实行前的那些年份与处理虚拟变量的交互项 xtreg ln_w did treated* i.year ,fe //这个没有加控制变量 xtreg ln_w did treated* $xlist i.year ,fe //如果did依然显著，且treated*这些政策施行前年份交互项并不显著，那就好 xtreg ln_w did treated* $xlist i.year if union!=1 ,fe //我们认为工会会影响这个处理组和控制组的共同趋势，因此我们看看union=0的情形 **2.政策干预时间的随机性 gen time1 = (year &gt;= 75) &amp; !missing(year) //政策执行时间提前到1975年 capture drop treated1 gen treated1= (idcode &gt;2000)&amp;!missing(idcode) //政策执行地方为idcode大于2000的地方 gen did1 = time1*treated1 //这就是需要估计的DID，也就所交叉项 gen time2 = (year &gt;= 76) &amp; !missing(year) //政策执行时间提前到1976年 capture drop treated2 gen treated2= (idcode &gt;2000)&amp;!missing(idcode) //政策执行地方为idcode大于2000的地方 gen did2 = time2*treated2 //这就是需要估计的DID，也就所交叉项 xtreg ln_w did1 $xlist i.year,fe xtreg ln_w did2 $xlist i.year,fe //看看这两式子里did1和did2显著不,显著为好 **3.控制组将不受到政策的影响 gen time3 = (year &gt;= 77) &amp; !missing(year) capture drop treated3 gen treated3= (idcode&lt;1600 &amp; idcode&gt;1000)&amp;!missing(idcode) //我们考虑一个并没有受政策影响地方假设其受到政策影响 gen did3 = time3*treated3 xtreg ln_w did3 $xlist i.year,fe //最好的情况是did3不显著，证明控制组不受政策影响 **4.政策实施的唯一性，至少证明这个政策才是主要影响因素 gen time4 = (year &gt;= 77) &amp; !missing(year) capture drop treated4 gen treated4= (idcode&lt;3000 &amp; idcode&gt;2300)&amp;!missing(idcode) //我们寻找某些受到其他政策影响的地方 gen did4 = time4*treated4 xtreg ln_w did4 $xlist i.year,fe //did4可能依然显著，但是系数变小，证明还受到其他政策影响 **5.控制组和政策影响组的分组是随机的 xi:xtivreg2 ln_w (did=hours tenure) $xlist i.year,fe first //用工具变量来替代政策变量，解决因为分组非随机导致的内生性问题 ———————————————————————————————— **附加的，一般而言，我们需要看看这个政策的动态影响------------- forval v=8/15{ gen treated`v&#39;=yrdum`v&#39;*treated } //注意，这里yrdum8就相当于year=78 reg ln_w treated* xtreg ln_w treated*, fe xtreg ln_w treated* i.year,fe xtreg ln_w treated* $xlist i.year,fe //一般而言上面这些式子里的treated*应该至少部分显著 倍分法 (DID)多个现成命令： help diff //sj16-1 help ddid //Pre-post-treatment estimation of the Average Treatment Effect (ATE) with binary time-varying treatment didq //Treatment-effect estimation under alternative assumptions, SJ 15(3):796--808 help absdid //Semiparametric difference-in-differences estimator of Abadie (2005), SJ16-2, 附数据和范例 —————————————————————————————————————— * RDD 多个断点--包括分析、画图、稳健 Analysis of regression-discontinuity designs with multiple cutoffs or multiple scores https://journals.sagepub.com/doi/pdf/10.1177/1536867X20976320 **RDD断点回归在这里的应用------------------- tab treated,missing keep if treated==1 cmogram ln_w year,cut(77) scatter lineat(77) qfitci //绘制断点回归图形 **最优带宽 set more off rdbwselect ln_w year if 60&lt;=year&amp;year&lt;=85,c(77) kernel(uni) //自己下载安装 rdob ln_w year, c(77) //这个命令是imbens新开发的，这里有rdob的程序 reg ln_w time $xlist if 60&lt;year&amp;year&lt;80 //直接对time这个虚拟变量做了ols 7.2.1 inequality不平等 /第一步：计算Gini 或 CI （常常画图） 第二步：分解 1）动态or面板：decomposition of a change in inequality – Stata命令：dsginideco(2017) - Decomposition of inequality change into pro-poor growth and mobility components adecomp(2012) - Shapley Decomposition by Components of a Welfare Measure 2）截面 – Stata命令：INEQDECO–Inequality decompositions by subgroup trnbin0 – count data Yvar 集中指数非线性分解法 ineqrbd – Regression-based inequality decomposition, following Fields (2003) ineqfac(2009) – Inequality decomposition by factor components, following Shorrocks (1982a, b) fgt_ci – calculates and decomposes Foster–Greer–Thorbecke (and standard) concentration indices rifireg(2016) - Recentered Influence Function (RIF) for (bivariate) rank dependent indices (I) regression / 1.gini decomp: “ginidesc” , “ineqdeco” , “ineqdec0” 1.各种系数计算: “inequal”→ “inequal7”→升级→“ainequal” 7.3 Plot/graph/visualisation help stripplot //画图比较多个分组的均值和分布 正态检验画图 sktest var // 正态检验, p&lt;0.00 则var不是正态 help diagnostic_plots swilk x // z&gt;2.14代表x不服从正态； p&lt;0.01代表不服从正态 pnorm x // 分布偏离斜线，也不服从正态。 gen u=rnormal(8, 3) //检验一下正态 现在的可视化工具webGL(graphical language)：一还是基于我们单机的统计分析；二优点在于”交互性”和”面向网络”； D3是基于JS：javascript, JSON=JavaScript Object Notation Plotly绘图底层基于D3 help libd3 //a Mata wrapper around the D3 JavaScript library help libjson help libhtml Longitudinal data可视化 help xtline help xtgraph boxplot箱线图，https://wiki.mbalib.com/wiki/%E7%AE%B1%E7%BA%BF%E5%9B%BE gr box x1 x2 //看几个变量(样本)是否具有有对称性，分布的分散程度。 3个命令Plots of mean CI over time twoway lfitci yvar xvar help caterpillar help ciplot //这种图也叫 Caterpillar ciplot yhb , by(ym) //医护比 graph combine 1.gph 2.gph , ysize(2) xsize(4) //合并时，调整graph图的纵横比 sixplot var //精简散点图, 一次出6连图（描述分布、正态、柱状）： binscatter //一个相见恨晚的stata命令 将这句three-way画图：tab ym hoslev , sum(wt) nost nofre egen meanwt=mean(wt), by(ym hoslev) separate meanwt, by(hoslev) twoway connected meanwt? ym2, c(L L) sort egen meancmi=mean(cmi), by(ym hoslev) //分类分组求均数，然后按年月画图连线 separate meancmi, by(hoslev) twoway connected meanwt? ym2, c(L L) sort title(DRG相对权重) xtitle(年月) ytitle(平均值) msymbol(S Oh) xline(201803) legend(label(1 &quot;二级医院&quot;)label(2 &quot;三级医院&quot;)) 画图 + code修图 sysuse auto, clear twoway scatter mpg rep78, msize(small) ||, graphregion(margin(r+50)) yti(&quot;里程数&quot;) xti(&quot;1978年的维修次数&quot;) gr_edit AddTextBox added_text editor `=82+8&#39; `=101&#39; gr_edit added_text_new = 1 gr_edit added_text[1].text = {} gr_edit added_text[1].text.Arrpush &quot;Mean mpg by rep78&quot; gr_edit AddTextBox added_text editor `=82+2&#39; `=112&#39; gr_edit added_text_rec = 2 gr_edit added_text[2].text = {} gr_edit added_text[2].text.Arrpush &quot;rep78 mpg&quot; 常用画图 twoway (scatter read write) (lfit read write) (kdensity pr1) //散点分布，回归拟合图 help mrgraph //分类变量画图 help mrtab 同时显示多个窗口graph grss twoway histogram price, frequency bin(20) grss twoway histogram weight, frequency bin(20) 茂睿的类似阴阳hist图 sysuse nlsw88 twoway (hist wage if union==1, frequency color(gs11) lwidth(none)) /// (hist wage if union==0, frequency color(none) lwidth(medium) lcolor(navy) legend(order(2 &quot;Non-union&quot; 1 &quot;Union&quot;))) 单变量--探索分布时，可用画图hist命令，非常直观 hist fee if own==1 &amp; icd10==&quot;O80.901&quot; &amp; fee&lt;6000 , bin(500) kden name(a) hist fee if own==1 &amp; icd10==&quot;O80.001&quot; &amp; fee&lt;6000 , bin(500) kden name(b) gr combine a b c d e f , row(3) col(2) help kdensity //画kernel图更好，两个命令，第一个是官方命令 help kdens 第一次用stata做直方图，其实命令比想象中简单，开始搞复杂了，而且发现也可以跟随stata的界面操作学习命令！直方图命令： graph bar (count) city1, over(city, gap(20)) ytitle(&quot;卫生人员数量&quot;) b1title(&quot;各设区市&quot;) blabel(bar) 7.3.1 地理地图map Extracting Chinese geographic data from Baidu Map API 中国地图地理 help cngcode //定位 help cnaddress //经纬度转中文地址 help cnmapsearch //根据关键词搜索给定经纬度周边的兴趣点，返回兴趣点的名称、中文地址、距离、标签等。 help chinagcode //利用百度地图获取中国地址的经纬度 help cntraveltime help grmap //12以前叫spmap 以spmap例子解释 use &quot;Italy-RegionsData.dta&quot;, clear //打开&quot;数据-库&quot; spmap relig1 using &quot;Italy-RegionsCoordinates.dta&quot;, id(id) //&quot;底图库&quot; 和 &quot;数据-库&quot;以id变量唯一识别link // 原理：将&quot;数据-库&quot;中 relig1 变量 plot在&quot;底图库&quot;上面 *转地理数据into Stata库 shp2dta -- reads a shape (.shp) and dBase (.dbf) file //栅栏文件shp和dbf都需要 mif2dta -- converts MapInfo Interchange Format files (aka MIF files) to Stata *地理经纬 geocode3 -- google升级到API3了, 其利用insheetjson和libjson(json library)两包解析网页,再返回给mata geocode3命令不认汉字, 只认拼音或汉字的utf-8编码 nearstat //计算距离distance命令 7.3.2 改scheme help schemes set scheme plotplain //我觉得最像R ggplot图风 set scheme Plottig, permanently // 对Stata单色模板的改进 set scheme s2mono, permanently //s2monochrome 是我一直用的喜欢scheme sysuse auto histogram price, scheme(michigan) percent title(“Automobile Prices”) // 非常漂亮图模 7.3.3 Output graph Stata figure出图终极解决方案–使用Ghostscript-gswin64c.exe： win10环境下安装Ghostscript, Step I. win10环境下根据Step II添加 C:\\Program Files\\gs926\\bin, 重启电脑就行了 方法：Stata出矢量pdf，然后Stata调用!gswin64c.exe 将pdf转tiff (也可设定dpi=r600，和压缩方式lzw)，我包装为程序figen figen, fig(D:\\fig1) // 括号中=路径和名称 doedit &quot;D:\\stata11\\ado\\myado/figen.ado&quot; //看ado,这个命令已定型，切勿再改 cap prog drop figen prog figen syntax, [if] [in] fig(str) graph export &quot;`fig&#39;.pdf&quot; !gswin64c.exe -dSAFER -dBATCH -dNOPAUSE -r600 -sDEVICE=tiff24nc -sCompression=lzw -sOutputFile=&quot;`fig&#39;.tiff&quot; &quot;`fig&#39;.pdf&quot; erase &quot;`fig&#39;.pdf&quot; end 7.4 EDA探索性分析 三适合探索新变量: des _all sum _all tab xx fre xx ins xx codebook xx ////怎么探索字符变量？告诉missing值、有多少unique values order varlist //左下框内变量排位置用order和move命令 sort name year //在排序的时候可以用上两个变量，这样先name后year就不会乱了year sort X, stable //而sort加选项stable可以使排序最简洁最快 比较灵活的fsum fsum transaction if n==600578 &amp; date&gt;date(“2007-05-20”,“YMD”) &amp; date&lt;date(“2007-05-31”,“YMD”) ,f(11.0) //日期 fsum , stats(n) label //输出所有var和var label 描述性分析： cap !erase 2.csv // 省去手动删excel文件 // categorical var foreach v of varlist hl hisb_hc age edu gender marital $ill { quiet estpost tab `v&#39; if !mi($nomis) quiet esttab using 2.csv, cells(&quot; b(label(freq)) pct(fmt(2))&quot;) unstack nonumber noobs append } // continuous var quiet estpost sum w if !mi($nomis) quiet esttab using 2.csv, cells(&quot; mean(fmt(2)) sd(fmt(2)) &quot;) unstack nonumber noobs append 7.4.1 Output输出 table输出Excel(csv)终极解决方案： ` foreach v of varlist $covs { estpost tab `v&#39; cl , chi2 // cl=cluster，是分层指示变量 quiet esttab using &quot;$path\\BWS_organ\\new_survey\\tab_BWS_aggregate_score.csv&quot;, cells(&quot;b(label(freq)) colpct(fmt(2))&quot;) unstack nonumber noobs append } esttab CL using 2.csv, mtitles(&quot;Conditional Logit&quot;) nogaps pr2 scalars(ll r2_p ) nodep nonum se unstack append table输出Word(rtf)终极解决方案： ` esttab urban using 2.rtf , unstack replace nonum /// mtitles(&quot;Logit model&quot;) /// starlevels(* 0.10 ** 0.05 *** 0.01) addnotes(&quot;* p&lt;0.10, ** p&lt;0.05, *** p&lt;0.01&quot;) /// cells(b(star fmt(%9.3f)) se(par)) /// stats(N ll chi2 r2_p bic, star(chi2) fmt(%9.0g %9.3f)) /// varlabels(edu &quot;Higher education&quot; age &quot;Age&quot; gender &quot;Male&quot; _cons Constant) esttab 导出latex table，需要\\label{tab2}, 直接在esttab选项里 title(...\\label{tab2}) 读入tab_BWS_aggregate_score.csv 然后用mata转成Latex表 `import delim using &quot;d:\\tab_BWS_aggregate_score.csv&quot; , clear gen att_id=_n rename v1 att_name order att_id , b(att_name) * tex output : texsave把Stata数据库中数据做成latex表格 texsave _all using &quot;d:\\tab_BWS_aggregate_score.tex&quot; , frag replace /// title(Aggregated best-worst scores) /// footnote(Note: The number of respondents is xxx) 输出表格table命令汇总： summary矩阵表格化tabulating matrix as publication frmttable 其可以利用outreg的选项，如annotate(pcts) asymbol(“%”)加百分号，还可以自由改表头 estimates矩阵表格化 estout 或者 frmttable, outreg - outreg太多bugs，常需要run几次才能出一个表格 esttab最推荐*****，因为esttab可以调用estout(太麻烦不推荐)的选项 Summary statistics → plain text and LATEX files with tabout (Watson 2007), outreg2, estpost(distributed with the estout) estimation tables → Word and LATEX tables with outreg (which uses frmttable for formatting) → plain text and LATEX tables with outreg2 (Wada 2005), estout(Jann 2007), esttab(a wrapper for estout) → formatted Excel file with xml-tab (Lokshin and Sajaia 2008) ，选择性输出改动excel： putexcel(Stata 13) * 最强的(可将matrix完美输出成table)： estimation/Summary → Word and LATEX tables with frmttable (gallup 2012) , outtable (Baum and Azevedo 2008) outreg(gallup 2013)是frmttable的升级包装版，outreg可用frmttable的选项 * 教你各种表格（可自动run命令） help tabletutorial * 输出后各类型文件转换、编译 help translate //-- Print and translate logs help texify // 等价于 !pdflatex myoutput.tex -no-shell-escape help ttab // ttab is basically a wrapper for ttest and estout. 大规模ttest时用 • The &quot;estout package&quot; contains four commands: esttab: User-friendly command to produce publication-style regression tables for screen display or in various export(CSV, RTF, HTML, or LaTeX) estout: Generic program to compile regression tables (engine behind esttab) estadd: Program to add extra results (such as beta coefficients) to e() so that they can be tabulated. eststo: Improved version of estimates store. LaTeX and Stata integration: 很漂亮的表 今天自编gr2tex(利用texdoc) ：一输出graph为pdf保存；二将引用latex code插入draft global path D:\\desk\\Googledrive\\fj_pilot_organ cd $path sysuse auto scatter price wei gr2tex , pdf($path\\draft\\output\\aa) draft($path\\draft\\bws_organ) tex3pt -- creates LaTeX documents from esttab output using the LaTeX package threeparttable. texdoc -- write into tex file. (texdoc 用Stata14跑一直出错，只能13跑) 7.5 Connection 7.5.1 Stata &amp; Mplus 联用调用 – dta格式转Mplus的dat格式： stata2mplus using c:2.dta // this creates c:2.dat and c:2.inp – Stata中运行Mplus help runmplus // see: http://www.lvmworkshop.org/home/runmplus-stuff 7.5.2 epidata文件导出 6数据导出 -&gt; Stata格式 -&gt; 选择.rec文件 7.5.3 R/Python 使用python语言在Stata中： python exit() shellout python_plugin.pdf //详细介绍 Stata-R语言联用,方法一: “rsource”,我做SP问卷输出和数据处理采用的 doedit &quot;D:\\aa\\book_Stata_Latex_R\\Stata_R_SP.do&quot; 已经修改profile.do文件, R-Stata联用设置 这样就可以在Stata中写R代码 调用R的功能 global Rterm_path `&quot;D:\\R\\R-4.0.3beta\\bin\\x64\\Rterm.exe&quot;&#39; //specify them in order to call R in Stata global Rterm_options `&quot;--vanilla&quot;&#39; //例子 rsource, terminator(END_OF_R) library(foreign); rauto&lt;-read.dta(&quot;myauto.dta&quot;, convert.f=TRUE); rauto; attributes(rauto); q(); END_OF_R 方法二：“rcall” 比rsource强的是有interactive模式 net install Rcall, replace from(&quot;d:\\rcall&quot;) help rcall library(&quot;foreign&quot;, lib.loc=&quot;D:/R/R-Portable/App/R-Portable/library&quot;) data&lt;-as.data.frame(med$alternatives$alt.1) # med是list类型的对象, alt.1是attributes组合的对象 write.dta(data,&quot;d:/test.dta&quot;) * R里面的表格tab_BWS_aggregate_score.csv 输出，再用Stata转成Latex表 rcall:data&lt;-as.data.frame(scores$aggregate) # med是list类型的对象, alt.1是attributes组合的对象 rcall:write.csv(data,&quot;d:/tab_BWS_aggregate_score.csv&quot;) # 这个表待会读入Stata，然后用mata转成Latex表 insheet using &quot;D:\\aa\\CLDS\\BMI\\clds2016_m.csv&quot;, clear import delim using &quot;d:\\tab_BWS_aggregate_score.csv&quot; , clear texsave _all using &quot;d:\\tab_BWS_aggregate_score.tex&quot; , frag replace /// title(Aggregated best-worst scores) /// footnote(Note: The number of respondents is xxx) ***例子：综合控制法 rcall:data(gsynth) rcall:names(turnout) rcall:set.seed(123456) rcall:turnout.ub &lt;- turnout[-c(which(turnout$abb==&quot;WY&quot;)[1:15], sample(1:nrow(turnout),50,replace=FALSE)),] rcall:out &lt;- gsynth(turnout ~ policy_edr + policy_mail_in + policy_motor, /// data = turnout.ub, index = c(&quot;abb&quot;,&quot;year&quot;), se = TRUE, inference = &quot;parametric&quot;, r = c(0, 5), /// CV = TRUE, force = &quot;two-way&quot;, parallel = TRUE, min.T0 = 8, nboots = 1000, seed = 02139) rcall:print(out) rename var1 t tsset t twoway tsline att cilower ciupper,xline(0) yline(0) scheme(s2mono) rcall:out.mc &lt;- gsynth(turnout ~ policy_edr + policy_mail_in + policy_motor, min.T0 = 8, /// data = turnout.ub, index = c(&quot;abb&quot;,&quot;year&quot;), estimator = &quot;mc&quot;, /// se = TRUE, nboots = 1000, seed = 02139) rcall:plot(out.mc, main = &quot;Estimated ATT (MC)&quot;) rcall:print(out.mc) rename var1 t tsset t twoway tsline att cilower ciupper,xline(0) yline(0) scheme(s2mono) 方法三：在R语言中run Stata library(“RStata”) 7.5.4 DOS/shell/web shell erase do_file.do //shell (等价&quot;!&quot;) allows you to send commands to your operating system shell // or to enter DOS界面 !erase myfile.txt // DOS命令erase/del一样 !del myfile.tex !rename try15.dta final.dta !rmdir D:\\aa\\manydoc\\bak.stunicode /s /q //多运行一遍, 删除整个文件夹 winexec notepad &quot;d:\\myfile.txt&quot; //Stata命令 allows you to open file by using notepad Stata以keyword为字符变量，逐个代入网页，拷贝网页内容 levelsof keyword,local(levels) foreach c of local levels { copy &quot;http://www.baidu.com/s?wd=`c&#39;&quot; &quot;D:\\temp.txt&quot;,replace infix strL v 1-200000 using &quot;D:\\temp.txt&quot;,clear keep if index(v,&quot; 百度为您找到相关结果约&quot;) replace v = ustrregexs(1) if ustrregexm(v,&quot; 约(.+?)个&quot;) local date = c(current_date) local time = c(current_time) post baidu (&quot;`date&#39;&quot;) (&quot;`time&#39;&quot;)(&quot;`c&#39;&quot;) (v[1]) } postclose baidu use&quot;D:\\baidu.dta&quot;,clear replace baidu = ustrregexra(baidu,&quot;,&quot;,&quot;&quot;) destring baidu,replace 7.5.5 Latex/Markdown 放弃Stata动态文件编写(stata14终于能完美支持ASCII中文了): markdoc, ketchup Stata输出eps图，插入Latex，再编译 cd d:\\ sysuse auto * run reg eststo mytab: reg mpg weight length esttab mytab using &quot;mytable.tex&quot;, style(tex) replace * draw graph.eps, turn to .pdf scatter mpg length graph export mygraph.eps, replace !epstopdf mygraph.eps // 将eps图片转pdf,适合在latex中插入 * compile pdf by latex !pdflatex myoutput.tex -no-shell-escape /* epstopdf和pdflatex都是MiTex的功能 shell-escape是pdflatex的一个选项 */ !pdflatex CTang_CV.tex -output-directory=.\\output\\ //定向编译 !copy .\\output\\CTang_CV.pdf .\\ //再copy pdf到本文件夹 % Latex file myoutput.tex \\documentclass[11pt]{article} \\usepackage{graphicx} \\begin{document} \\section{My table} \\input{mytable.tex} \\section{My graph} \\includegraphics{mygraph.pdf} \\end{document} Stata回归、制table，插入Latex program main prepare_data run_regressions output_table end program prepare_data use ../external/tv_potato.dta, clear xtset countycode year label variable log_chip_sales &quot;Log Chip Sales&quot; label variable tv_linear &quot;TV&quot; end program run_regressions // 调用下面的 program setup_table local dep_var &quot;log_chip_sales&quot; local tv_vars &quot;tv_linear&quot; local vce &quot;vce(cluster countycode)&quot; eststo: reg `dep_var&#39; `tv_vars&#39;, `vce&#39; setup_table, unitvar(countycode) timevar(year) eststo: xtreg `dep_var&#39; `tv_vars&#39;, `vce&#39; setup_table, unitvar(countycode) timevar(year) eststo: reg `dep_var&#39; `tv_vars&#39; i.year, `vce&#39; setup_table, unitvar(countycode) timevar(year) eststo: xtreg `dep_var&#39; `tv_vars&#39; i.year, `vce&#39; setup_table, unitvar(countycode) timevar(year) end program setup_table // 被上面的program run_regressions调用 syntax, unitvar(varname) timevar(varname) if &quot;`e(ivar)&#39;&quot; == &quot;`unitvar&#39;&quot; { estadd local unit_fe &quot;Yes&quot; } else { estadd local unit_fe &quot;No&quot; } local cmdline &quot;`e(cmdline)&#39;&quot; local cmd_substr : subinstr local cmdline &quot;i.`timevar&#39;&quot; &quot;&quot;, count(local cmd_time_fe) if `cmd_time_fe&#39; == 1 { estadd local time_fe &quot;Yes&quot; } else { estadd local time_fe &quot;No&quot; } end program output_table esttab using ../output/regressions.tex, /// replace drop(*.year) /// obslast se label nonotes nomtitles collabels(none) /// cells(b(star fmt(4)) se(par fmt(4))) /// scalars(&quot;unit_fe County Fixed Effects&quot; &quot;time_fe Year Fixed Effects&quot;) /// mgroups(&quot;Log of Chip Sales&quot;, pattern(1) prefix(\\multicolumn{@span}{c}{) /// suffix(}) span erepeat(\\cmidrule(lr){@span})) end main // 启动执行 Table - r1_mandatory and r2_mandatory’s before-after mean comparison - by countries preserve * sample selection drop if Country==&quot;&quot; | r1==. // r1 和 r2 的missing obs完全一样 * T-test and mean comparison encode Country, gen(country) // string → numerical, so can be used by next ttab foreach v in 1 2 { ttab r`v&#39;_mandatory, by(post) over(country) // calculate difference mat r=r(coefs) ttab r`v&#39;_mandatory, by(post) // for total mat t=r(coefs) ttab r`v&#39;_mandatory, by(post) over(country) tshow // calculate t-stat mat rr=r(coefs) ttab r`v&#39;_mandatory, by(post) tshow mat tt=r(coefs) tabstat r`v&#39;_mandatory , by(country) s(mean count) save // calculate mean and observations tabstatmat A mat rr=[r\\rr] mat tt=[t\\tt] mat rr=[rr,tt] mat rr=rr&#39; mata: st_matrix(&quot;rr&quot; , select(st_matrix(&quot;rr&quot;),(1,1,1,0,0,1))) //2个mata函数，2个功能 mat out`v&#39;=[rr, A] } mat out=[out1 , out2] mat colnames out = &quot;Before IFRS&quot; &quot;After IFRS&quot; Diff T-stat Total N &quot;Before IFRS&quot; &quot;After IFRS&quot; Diff T-stat Total N mat rownames out = AUSTRALIA AUSTRIA BELGIUM CANADA DENMARK FINLAND FRANCE GERMANY GREECE &quot;HONG KONG&quot; INDIA INDONESIA IRELAND ITALY JAPAN KOREA(SOUTH) MALAYSIA NETHERLANDS NORWAY PAKISTAN PHILIPPINES PORTUGAL SINGAPORE &quot;SOUTH AFRICA&quot; SPAIN SWEDEN SWITZERLAND TAIWAN THAILAND &quot;UNITED KINGDOM&quot; &quot;UNITED STATES&quot; Total * 格式化out矩阵，加star local bc = rowsof(out) mat star = J(`bc&#39; , 12 , 0) foreach v in 4 10 { forvalues k = 1/`bc&#39; { if abs(out[`k&#39; , `v&#39;]) &lt;= 1.645 { mat star[`k&#39; , `v&#39;] = 0 } else if (abs(out[`k&#39; , `v&#39;]) &gt; 1.645 &amp; abs(out[`k&#39; , `v&#39;]) &lt;= 1.96 ){ mat star[`k&#39; , `v&#39;] = 1 } else if (abs(out[`k&#39; , `v&#39;]) &gt; 1.96 &amp; abs(out[`k&#39; , `v&#39;]) &lt;= 2.58 ){ mat star[`k&#39; , `v&#39;] = 2 } else if abs(out[`k&#39; , `v&#39;]) &gt; 2.58 { mat star[`k&#39; , `v&#39;] = 3 } } } * output word frmttable using output /*in default word */, statmat(out) annotate(star) asymbol(*,**,***) sdec(2,2,2,2,2,0,2,2,2,2,2,0 ) landscape a4 //tex option写成latex文件 restore 7.6 Data/Big data 随机数 set seed #### //给定初始数值，相同的初始数值生成的伪随机数列完全一致。 runiform() or rnormal(m, s) //随机正态, uniform() is for Stata 10 help rnd //random number generators -- 包括各种分布 节省行数 #delimit; gen lnpergas=ln(pergas);gen lngasp=ln(gasp); #delimit cr local/macro用法 macro list // 查看 macro drop _all // 清除 local a: display %6.2f ln(10) // local a: 后接命令， 类似 bysort hos: local cs 1 //while的loop好处是结果最终一起显示 while `cs&#39; == 1 { replace xxx省略xxx local cf=0 // 归0，否则会无限循环，或者用exit } 所以还是用 if 更好 if `cs&#39; ==1 { } 查看返回结果: `return list //看r() ereturn list //看e() r()中的数据导入矩阵： mat ic=nullmat(ic) \\ r(wtp) mat ic=nullmat(ic) \\ r(wtp) //column-join (\\) operators 可向下连续扩展矩阵 row-joinn 逗号 ， egen max=max(groupid_total) //提取var的最大值 区分 用.表示,比任何自然数都大，所以&gt;60会包括缺失值, 所以一定要限制上限! 是one string missing value，程序中用”“代替 区分 “/” 和 “-” 的用法 一个变量内数字用1/7250， 一个变量到另一个变量用pro1-pro7 区分 tab和table命令的输出格式很不一样！ tab type if num==1, sum(pro1) //按分类求均值，如9种卫生机构，各自的pro1的均值 区分Type和Format： Format指显示格式，并不改变数据大小。（如日期也是以数字存储的，可用format改成日期，而且日期变量赋值给别的变量会变成数字，因为没有指定format） Type指数据存储格式, e.g.如计算年龄age：gen age=(mdy(12,1,2009)-bir)/365.25，mdy是日期格式吗？ Stata 14 使用了 Unicode（统一码、万国码），之前的dofile只识别UTF-8编码，以前版本dofile都需要convert to UTF-8 by Notepad++。Stata 14 数据库打开时会乱码，转码如下： cd d:\\对应目录 unicode analyze *.do //或者 .dta数据文件 unicode encoding set gb18030 unicode translate *.do help getsymbols //API data from Quandl, Google Finance, Yahoo Finance, and Alpha Vantage 7.6.1 数据预处理 单纯转置stata数据库（非矩阵） help xpose help sxpose //Transpose of string variable dataset 填充/替代/ recode alt (1=1)(2=0), gen(ASC) //赋值神令,不用gen和replace；赋值规则是 gen ASC=0 if alt==2 | ASC=1 if alt==1 rename _all, lower //变量名称全部是英文小写 tsset Year //序列填充 tsappend , add(21) carryforward //分组填充 xfill bysort id: replace number=number[1] //组内第一个替代每一个 同一个变量前一个值赋给下一个： forvalues var=1/7250 { replace var=var[_n-1] if var==. } drop if _n==_N //drop the last obs 复制数据 expand 2 if ... // if范围内obs翻2倍 expand n , gen(id) // 所有obs翻n倍，同时产生id区分新旧obs 截取 gen y=mod(x,10) //截取数字的个位数, 同理可退后二位,三位,四位数 winsor &amp; truncate 缩尾 &amp; 截尾; 缩尾e.g.ln(1) → ln(1.01) 避免ln(1)=0 replace x=1.01 //目的是将离群值变成1%或99%分位值 loop over all the observations gen y=. forvalues i=1/`=_N&#39; { replace y=x[`i&#39;] if _n==`i&#39; } you&#39;ll get the exact same result far more quickly and easily with: gen y=x Stata命令前缀prefix, 如产生交互 i. to specify indicators for each level (category) of the variable c. to interact a continuous variable with a factor variable L. lag x_t-1 F. lead x_t+1 D. diff (x_t)-(x_t-1) S. diff (x_t)-(x_t-1) (seasonal) help fvvarlist //interaction–indicators交互项 factor variable，直接full factorial 筛选 有了inlist，你还在一直用if吗？ if语句： gen x=1 if rep78==1|rep==3|rep==4|rep==5 inlist函数：gen x=1 if inlist(rep78,1,3,4,5) gen y=1 if inlist(make,&quot;AMC Concord&quot;,&quot;AMC Pacer&quot;,&quot;Buick&quot;,&quot;Ford&quot;) keep if inlist(icd10,&quot;O80.901&quot;,&quot;O82.901&quot;,&quot;700001&quot;,&quot;O80.001&quot;,&quot;H25.901&quot;,&quot;H26.901&quot;) 7.6.2 字符 subinstr(s1,s2,s3,n)函数的应用–在s1中剔除s2，依次替换成n个s3，e.g. replace hos=subinstr(hos,char(10),““,.) char(10)就是这个可恶的ASCII为10的Line Feed符号 另有妙用： count if length(subinstr(pattern,”1”, ““, .))==1 //Counting substrings within strings gen x= y + z //合并字符 replace ctown = subinstr(ctown, “meizhou”, “putian”, 1) // 替换变量ctown中的 meizhou 为 putian. tostring destring v17, gen(vv17) force // 如果没有异常则实施强制转换 fdta _all , from(“AMC”) to(“SUV”) // 专门替代(字符变量)字符的命令，比subinstr()函数好用太多 fdta _all , from(“AMC”) // 替代性删除 substr(s,2,4) //截取字符函数, 从s的第2个字符开始截取4个字符 replace town=subinstr(town, “” , “” , .) //修改字符变量,删除字符中的星号 或空格 字符变量转数值变量 encode hosid , gen(hid) //encode可以完美的将字符型的factor变量 转换成 数值型的factor变量，而且带 label decode //vise verse 解决–csv含20位ID和中文字符，后缀1,2,4表示第1,2,4个变量 字符型导入。 PS：Stata无法加载16位以上数字digits并保持精度(会损失尾数精度)，这种情况只能以字符型处理 import delimited D:.csv, stringc(1,2,4) encoding(gb2312) clear import excel using “$path_tab.xlsx”, clear sheet(“医学专业招生在校毕业数52-2014”) cellrange(:o45) sheet(“SALC”) replace xxx= strlower(xxx) //字符串变小写, 注意：replace命令在使用时，如果赋值和原值相等，则不会计算在（？real changes made） 今天在计算1397个医院的人数时，结果只替代了1356个，就发现原来有41个医院前后人数相同。 从字符串最后面开始删掉两个字符: replace county=reverse(county) replace county=reverse(substr(county,3,8)) replace v=1 if regexm(id,&quot;福建省&quot;) //检查&lt;字符串变量&gt;是否含所需字符 replace v=3 if regexm(id,&quot;县&quot;) | regexm(id,&quot;区&quot;) destring var, replace //字符转数字出现问题 出現&quot;var contains nonnumeric characters&quot; 解决办法: gen byte notnumeric=real(var)==. //real()是函数,里面放出问题的变量名 tab notnumeric br if notnumeric==1 //==1 where nonnumeric characters 字符中的dot . count if regexm(pattern, &quot;\\.&quot;) 不能用 count if regexm(pattern, &quot;.&quot;) 通配符 regexm(str, &quot;[0-9]+\\.[0-9]*[%]$&quot;) 7.6.3 Time/age if year==1960 //don’t do this! if year[1]==1960 // right, first observation is 1960 drop if date2&lt;date(&quot;01jan2010&quot;,&quot;DMY&quot;) | date2&gt;date(&quot;30sep2011&quot;,&quot;DMY&quot;) //删除时间段 Age：算age（从单纯的年、月两个变量） gen birthdate=1 gen bir=mdy(birthmonth, birthdate, birthyear) // 用原始birthmonth，缺失值少 format bir %td gen age=(mdy(9,1,2014)-bir)/365.25 drop birthdate bir 日期: 设变量x是字符型，且格式是&quot;1-aug-02&quot; monthly(s1,s2[,Y]) date(s1,s2[,Y]) g m = monthly(actual_date, &quot;MY&quot;) //这里只能gen,不能replace,因为type mismatch format m %tmNN/CCYY g d = date(x,&quot;DM20Y&quot;) form d %td //extract month and year component from a variable (dm) with %tm format（e.g.1953m1） gen date = dofm(dm) format date %d gen month=month(date) gen yr=year(date) //一步到位牛逼的直接命令 https://blog.stata.com/2015/12/17/a-tour-of-datetime-in-stata-i/ help todate help anythingtodate anythingtodate cysj ,k //出院时间 hist cysjc12 if cysjc12&gt;date(&quot;2015-01-01&quot;, &quot;YMD&quot;) // YYYYMM date to &quot;ym&quot; Stata gen ndate = 201606 gen sdate = &quot;201606&quot; gen ndate2 = ym(floor(ndate/100), mod(ndate, 100)) gen sdate2 = ym(real(substr(sdate, 1, 4)), real(substr(sdate, -2,2))) format *2 %tm l +-----------------------------------+ | ndate sdate ndate2 sdate2 | |-----------------------------------| 1. | 201606 201606 2016m6 2016m6 | +-----------------------------------+ // gen rysj2 = date(string(rysj,&quot;%8.0f&quot;),&quot;YMD&quot;) format %td rysj2 7.6.4 Stata矩阵和Mata mat l e(b) //查看系数矩阵,矩阵导出到excel matlist 比 matrix list 更方便display矩阵 matrix -&gt; variables svmat // svmat2 A , rnames(ym) full //可把所有rownames save into a variable mkmat // variables -&gt; matrix xsvmat 将统计频数转入mat，再mat转variables，再画图 tab edu urban, matcell(aa) // 频数直接存入矩阵aa,此命令不会抹掉existing data，而是自动列在后面 svmat aa gen n=_n in 1/6 label define edu2 1&quot;High_school&quot; 2&quot;SVD&quot; 3&quot;College&quot; 4&quot;Bachelor&quot; 5&quot;Master&quot; 6&quot;PhD&quot; label values n edu2 graph bar aa1 aa2 , over(n) ytitle(Number of physicians) b1title(Education) legend(label(1 Rural hospitals) label(2 Urban hospitals)) svmat A //矩阵画图-连线图 drop in 24 gen n=_n graph twoway connected A1 n Speaking Stata between tables and graphs tabout–属于Stata自带基本命令，是基本统计量表格输出的好命令 tabstat v11-v16, by(v3) s(mean) //tabstat妙用–做多个变量按同一分组统计均数 help taboutgraph //a wrapper for tabout, plot output of two-way tab function taboutgraph var1 var2 [aw=weight] using &quot;filename_to_savedatato.csv&quot;, /// gc(&quot;graph bar&quot;) ta(cells(col) f(2 2 2 2)) replace go( note(&quot;Source: XXX&quot;) /// b1title(&quot;Quintile&quot;) title(`&quot;Composition of Population&quot;&#39;) ytitle(&quot;Percent of population in the quntile&quot;)) 用统计table画图命令 collapse/contract：Make dataset of summary/freq statistics这个命令太好了 preserve collapse draft, by(timing year) //Make dataset of summary statistics gen ldraft=log(draft) twoway(connect ldraft year if timing==1955, lcolor(black)) /// (connect ldraft year if timing==1956,msymbol(diamond) lcolor(pink) lpattern(dash)), legend(off) /// text(10.49 1955.5 &quot;Collectivization in 1955 (569 counties)&quot;, color(black)) /// text(10.58 1955.7 &quot;Collectivization in 1956 (1031 counties)&quot;, color(pink)) /// xline(1954, lcolor(black)) xline(1955, lcolor(pink) lpattern(dash)) /// xtitle(&quot;year&quot;) ytitle(&quot;log(number of draft animals)&quot;) restore 互换矩阵和descriptive statistcs gen a=1 //为了两年间数据均衡，删掉某一年没数据的医院 bysort hos: gen pn=sum(a) bysort hos: egen b=max(pn) drop if b&lt;10 drop if regexm(hos,&quot;漳平市妇幼保健院&quot;) replace hos=subinstr(hos,char(10),&quot;&quot;,.) //去除hos字符断行问题 encode hos, generate(hos1) //encode是为了下句mean的over选项 方法一 倒数-&gt; 哈氏乘法 label drop hos1 quietly: mean lfdc if year==2010,over(hos1) //over只能用numeric变量 mat lfdc1=e(b) quietly: mean lfdc if year==2011,over(hos1) mat lfdc2=e(b) quietly:mean drugout if year==2010,over(hos1) mat drug1=e(b) quietly:mean drugout if year==2011,over(hos1) mat drug2=e(b) mat xx=[lfdc1\\lfdc2] // 右下斜杠是分行，逗号是并列。 mat yy=(drug1\\drug2) local aa=rowsof(yy) //本loop将矩阵各值取倒数 local bb=colsof(yy) forval x=1/`aa&#39; { forval y=1/`bb&#39; { mat yy[`x&#39;,`y&#39;]=1/yy[`x&#39;,`y&#39;] } } mat ld=hadamard(xx,yy) //哈氏乘法--元素*元素，且乘以倒数==相除 local cn=e(over_labels) //问题2，引用e(over_labels)赋值给ld mat rownames ld=2010 2011 mat colnames ld=&quot;`cn&#39;&quot; mat ldt=ld&#39; mat l ldt local : rownames ld 方法二 tabstatmat tabstat lfdc drugout if year==2010, by(hos) s(mean) save //save选项将结果存入r() tabstatmat A //关键命令 tabstat lfdc drugout if year==2011, by(hos) s(mean) save //save选项将结果存入r() tabstatmat B local cc=rowsof(A) forval x=1/`cc&#39;{ mat A[`x&#39;,1] = A[`x&#39;,1]/A[`x&#39;,2] mat A[`x&#39;,2] = B[`x&#39;,1]/B[`x&#39;,2] } mat colnames A=2010 2011 mat l A 方法三 statsmat //Produce matrix of descriptive statistics foreach x in 1 2 3{ // 先按三个病种Loop foreach v of varlist day fee feeday drug drugday{ // 再每个病种的变量 statsmat `v&#39; if case==`x&#39;, by(own) mat(`v&#39;`x&#39;) s(mean sd) f(%3.2f) xpose } } Stata矩阵区别于mata矩阵，得互相调用 st_view() make Mata matrices &quot;x&quot; from a Stata dataset &quot;varname&quot; st_data() Load copy of current Stata dataset st_numscalar() obtain value from colsum(x) and put into r(sum) // mata里面用Stata的矩阵切记加双引号&quot;&quot; mata: st_matrix(&quot;rr&quot; , select(st_matrix(&quot;rr&quot;),(1,1,1,0,0,1))) //3个mata函数，3个功能，st_matrix()将stata中的matrix转给mata mata: st_matrix(&quot;temp&quot;):/st_matrix(&quot;xiaono&quot;) //element-by-element相除， 相乘用 :* mata: st_matrix(&quot;JJ&quot;, st_matrix(&quot;aa&quot;):/st_matrix(&quot;minorno&quot;)) //JJ是Stata矩阵不是mata矩阵 mata矩阵A，直接type矩阵名就list矩阵（不像Stata矩阵需要mat list命令） A 方式一 &gt;mata: istmt //for programmers,单行不要end &gt;mata: Z[., .]=X:-mean(X) //每个ob减mean(X)就是center a variable on the mean 方式二 &gt;mata //if an error occurs, still stay in mata &gt; istmt &gt;end Mata最大优点：可任意自编函数 → 问题来了：很多函数如何储存？ help mata mlib //a group of functions, like library help max() //两命令不同 help mata max() mata query // mata setting mata describe //最常用两mata命令 mata drop mata clear viewsource diag.mata help moremata //see extra mata function, especially their source code 7.6.5 Big data 超大数据-电脑内存利用超97%，首先进去drop变量 describe using “bigfile.dta” //不加载bigfile进内存 lookfor and lookfor_all use list_of_variables using use in use if use if inrange(runiform(),0,.1) using “bigfile.dta” help ftools //Stata处理大数据的新套件 help gtools help parallel //stata并行处理多个文件 "],["python.html", "Chapter 8 Python 8.1 Deepnote 8.2 Network science(complex network) 8.3 Plot and visualisation", " Chapter 8 Python 8.1 Deepnote The best platform for Python/R, which is cloud-based, real time, no install requirements, with lots of packages already installed. Disadvantages: 1) Running speed is low for R, compared to my RStudio. 2) For R, packages combination is not well-supported, so the dockerhub image is required for setting up environment. 8.2 Network science(complex network) NetworKit is a growing open-source toolkit for large-scale network analysis. This moduler includes standard measures of network analysis, such as degree sequences, clustering coefficients, centrality measures, and more. 8.3 Plot and visualisation Plotly是一个开源，交互式的Python图形库(同类产品是bokeh)，有在线/离线两种模式(Jupyter Notebook )，基本功能免费，支持Python, MATLAB, R等多语言， Python绘图组合: 1. cufflinks+express+plotly; 2. bokeh+hvplot 交互式图表: ggplot(移植) -&gt; plotly(封装) -&gt; cufflinks 统计图表: matplotlib(封装) -&gt; seaborn "],["sqltableaupowerbi.html", "Chapter 9 SQL/Tableau/PowerBI 9.1 SQL 9.2 Tableau 9.3 Power BI", " Chapter 9 SQL/Tableau/PowerBI REDCAP is based on MySQL, still a data store and management tool 9.1 SQL SQL(Structured Query Language) is used to create queries to manipulate the data stored in a database. Oracle SQL, is one like Microsoft SQL Server, PL/SQL 声明式编程(Declarative programming, e.g. SQL) VS. 命令式编程(Imperative programming), however Python is usually coded in an imperative way but can use the declarative style if necessary. 声明式编程 allow users to focus more on the desired outcome than the exact computational steps required to achieve that outcome. This can increase efficiency and code readability Case: Oracle安装备忘录 *新农合数据 oracle 11.2.0.1.0 下载及安装教程：https://jingyan.baidu.com/article/363872eccfb9266e4aa16f5d.html *安装在C:\\Oracle *dmp原始数据在D:\\Oracle\\XXX *dmp加载到数仓dbf在D:\\app\\XNH\\oradata\\oracledb 口令通用：XNHsc2018 sqlplus用户名 system *基层卫生信息系统(phis数据) oracle 12.1.0.2.0 用户名：XNH 口令：XNHsc2018 *基目录D:\\app\\XNH *安装在D:\\app\\XNH\\product\\12.1.0\\dbhome_2 *数仓在D:\\app\\XNH\\oradata 全局数据库名：oraclebd 口令：XNHsc2018 可插入数据库名：pdborcl *登录提示 用户名：每个区县的具体数据库名字，例如剑阁：PHIS_JGS 密码：123 Case: plsql改流水号格式 建表和查询 CREATE TABLE ZYZDDETAIL_1 AS SELECT TO_CHAR(id) id, zyid, JBBM, LOGINUSERID, LOGINDATE, UPDATE_TIME FROM ZYZDDETAIL; Case: sqlplus导入数据(麻烦，后来转Stata+ODBC ) 1.需要确认需要的表空间 1.1创建表空间则不需要remap_tablespace 1.2不创建表空间，可以使用REMAP_TABLESPACE=ehr:users,tbs_phis:users这种语法把ehr和tbs_phis表空间中对象映射到users 1.3确认表空间可以在导入过程中查看报错，报错日志显示有缺少XXX表空间的情况下，按一次CTRL+C，再输入KILL_JOB，再YES，退出报错的导出，删除导入的用户，重新导入 1.4常见表空间（不全）SPS_PHIS、TBS_LOG、TBS_PHIS、PHIS_HIS 2.创建directory 2.1确认dmp文件所在位置，例如：dmp位于D:\\bak，必须直接能读取到dmp的路径； 2.2打开sqlplus，执行：system/XNHsc2018 create or replace directory full as &#39;D:\\bak&#39;; create or replace directory full as &#39;D:\\Oracle\\jiange&#39;; //一定要加分号！ 3.导入代码 cmd执行&quot;剑阁示例&quot; impdp system/XNHsc2018@localhost/oracledb dumpfile=jg180915_%U.dmplogfile=jg180915_imp.log directory=full remap_tablespace=SPS_PHIS:users,TBS_LOG:users,TBS_PHIS:users,PHIS_HIS:users parallel=6 cluster=n Open Database Connectivity (ODBC) interface makes it possible for applications(Stata/R) to access data from a variety of database management systems (e.g. SQL Server). 首先，搜索ODBC管理员，点击系统DNS添加。 然后，添加后点击对应的数据目录，本次安装在home2，然后进行数据添加。 datasourcename:自己命名的调用数据库名，用英文。 description：数据库描述，可以用中文。 TNS Service Name：oraclebd就是oracle导入的实例数据库。 User ID：每个县对应的ID数据库名字，比如如图所示为东坡，可在导出log中查看。 *每个县有一个数据库，所以要建立相应县个数的ODBC。 odbc list //Stata通过ODBC查询调用任意SQL数据 help odbc Stata中ODBC查询 9.1.1 R_SQL Searching SQL on the website R bloggers will get collections of studying R_SQL Datasets are in different forms, places, access, pls use a config file - Connect R with SQL Writing large datasets to SQL Server can be very slow using the DBI package with an ODBC connection - Fast SQL Server Imports with R PowerBI Desktop can directly get Data&gt;SQL Server raw Database to visualize, but it less cautious - SQL Server, Power BI, and R SQL is declarative, so the lack of control flow produce redundancy用更精简的imperative编程代替啰嗦的SQL语言 - generating readable SQL queries using {dbplyr} and {sqlfluff} 9.2 Tableau Tableau(所有方面比Power BI好的拖动式画图软件) 9.3 Power BI Key words: interactive data visualization, Microsoft, business intelligence(BI) "],["survey-1.html", "Chapter 10 Survey 10.1 SoJump", " Chapter 10 Survey 10.1 SoJump We test our hypotheses in the context of a randomized experiment. The experiment was embedded in a larger online survey administered to Chinese adults in November 2014. China is particularly suitable for this study as it is not only the largest developing country, but also one of the most popular hosts of FDI. The survey was implemented by SoJump, an Internet marketing research firm in China, which drew a sample of 2,224 respondents from its 2.6 million registered subjects. (Upon completion of the survey, respondents received points that can later be exchanged for cash. Detailed information about the panel can be found at SoJump’s website at http://www.sojump.com/. For recent studies using a similar approach in China, see Li (2017) and Truex (2014).) Li, X., &amp; Zeng, K. (2017). Individual Preferences for FDI in Developing Countries: Experimental Evidence from China. Journal of Experimental Political Science, 4(3), 195-205. doi:10.1017/XPS.2017.15 Truex, R. (2014). Consultative Authoritarianism and Its Limits. Comparative Political Studies, doi: 10.1177/0010414014534196. 10.1.1 文本录入模板 生命质量调查问卷 您好，这份问卷是关于您的个人生命质量的一个调查。您的回答将有助于改进健康和养老服务供给的相关政策。 您的所有回答都将严格保密！除了研究人员，不会有其他人可以接触到您的答案。答案无对错之分，请按真实感受打分。 请在下列各组选项中，指出哪一项最能反映您今天的健康状况，并点击选择该项。 A1．行动[必答题] 我可以四处走动，没有任何困难。 我行动有些不方便。 我不能下床活动。 A2．自己照顾自己[必答题] 我能自己照顾自己，没有任何困难。 我在洗脸、刷牙、洗澡或穿衣方面有些困难。 我无法自己洗脸、刷牙、洗澡或穿衣。 A3．日常活动(如工作，学习，家务事，家庭或休闲活动)[必答题] 我能进行日常活动，没有任何困难。 我在进行日常活动方面有些困难。 我无法进行日常活动。 A4．疼痛 / 不舒服[必答题] 我没有任何疼痛或不舒服。 我觉得中度疼痛或不舒服。 我觉得极度疼痛或不舒服。 A5．焦虑 (如紧张、担心、不安等等) / 抑郁 (如做事情缺乏兴趣、没乐趣、提不起精神等等)[必答题] 我不觉得焦虑或抑郁。 我觉得中度焦虑或抑郁。 我觉得极度焦虑或抑郁。 A6．为了帮助您反映健康状况的好坏，我们画了一个刻度尺(有点象温度计)，在这刻度尺上， 100 代表您心目中最好的状况，0 代表您心目 中最差的状况。 请在右边的刻度尺上标出您今天的健康状况。 请从下面方格中画出一条线，连到刻度尺上 最能代表您今天健康状况好坏的那一点。[比重题][必答题] 心目中最好的健康状况 下面是有关生命质量的问题，重点了解您认为生命中最有价值的能力和功能。请指出哪项陈述最能描述您的整体生命质量，并点击选择该项。 注意：对于每个问题的回答，请从尽量多的自身能力和外在环境来考虑。如对”稳定和安全感”的问题回答，可能综合了您近一年来的健康情况、工作状况、家庭经济条件、社会关系等，也包括您对国际国内社会的和谐与稳定等的判断。 B1．稳定和安全感[必答题] 我能在生活中所有领域感受到稳定和安全感 我能在生活中很多领域感受到稳定和安全感 我能在生活中少数领域感受到稳定和安全感 我在生活中任何领域都感受不到稳定和安全感 B2．爱，友善与支持[必答题] 我能获得大量的爱，友善与支持 我能获得很多的爱，友善与支持 我能获得少许的爱，友善与支持 我得不到任何的爱，友善与支持 B3．独立性[必答题] 我能够完全独立 我能够在很多方面独立 我能够在一些方面独立 我完全不能独立 B4．成就与进步[必答题] 我能在生活的所有方面取得成就与进步 我能在生活的很多方面取得成就与进步 我能在生活的某些方面取得成就与进步 我无法在生活的任何一方面取得成就与进步 B5．享受和快乐[必答题] 我很会享受并能获得非常多快乐 我会享受也能获得一些快乐 我不太会享受只能获得少许快乐 我不会享受也无法获得任何快乐 C1．您的性别[必答题] 1.男 2.女 C2．您出生于_______年_______月。[填空题][必答题] C3．您的学历[必答题] 1.汉族 2.壮族 3.满族 4.回族 5.其他 C4．您的婚姻状况[必答题] 1.未婚 2.已婚并共同生活 3.已婚但分居 4.离婚 5.丧偶 6.其他 C5．您的学历[必答题] 1.小学以下 2.小学 3.初中 4.高中或中专 5.大学专科 6.大学本科 7.硕士及以上 C6．您目前的职业[必答题] 1.农林牧渔水利行业 2.生产运输 3.商业服务 4行政干部或管理人员 5.办事人员 6.技术人员 7.离退休人员 8.在校学生 9.无业或失业 10.其他 C7．户口所在地: [必答题] 1.本辖区 2.本辖区以外 C8．户籍类别: [必答题] 1.非农业户口 2.农业户口 C9．您拥有的医疗保险 [多选题][必答题] 0.无任何医疗保险 1.公费医疗 2.城镇职工基本医疗保 3.城镇居民基本医疗保险 4.新型农村合作医疗保险 5.商业医疗保险 6.其他 C10．总体上来说，您觉得现在的生活很幸福吗？[必答题] 1.非常幸福 2.比较幸福 3.一般 4.不太幸福 5.非常不幸福 C11．您家中有经济收入的成年人共_____位[填空题][必答题] C12．您家过去三个月人均月收入(包括所有来源)是多少[必答题] 1.&lt;1000元/月 2.1000-2000元/月 3.2000-3000元/月 4.4000-50000元/月 5.50,000元/月及以上 6.不详 C13．您家的经济收入来源主要是 [多选题][必答题] 1.工资性收入 2.农业生产或经营买卖收入 3.其他收入 C14．您家的房屋类型是[必答题] 1.楼房 2.平房 3.其他 C15．房间数_____[填空题][必答题] 问卷星格式 问卷星格式 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
